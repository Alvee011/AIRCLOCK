<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIRCLOCK - On Time Worldwide</title>
    <link rel="icon" href="fav.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://worldtimeapi.org">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js" defer></script>

    <style>
        :root {
    --bg-light: #d8dbe0; /* Light mode background color (5% darker) */
    --text-light: #2c3e50; /* Light mode text color */
    --bg-dark: #000000; /* Dark mode background color */
    --text-dark: #ecf0f1; /* Dark mode text color */
    --accent-light: #D4AF37; /* Golden accent for light mode */
    --accent-dark: #FFD700;  /* Golden accent for dark mode */
    --card-bg-light: #fffaf3; /* Warmer white for cards */
    --card-bg-dark: #1F1F1F; /* Card background in dark mode (deeper) */
    --shadow-light: 0 8px 25px rgba(0, 0, 0, 0.1); /* Shadow for light mode elements */
    --shadow-dark: 0 8px 25px rgba(0, 0, 0, 0.3); /* Shadow for dark mode elements */
    --border-light: rgba(0, 0, 0, 0.1); /* Border color in light mode */
    --border-dark: rgba(255, 255, 255, 0.1); /* Border color in dark mode */
    --btn-bg-light: #f3f4f6;
    --btn-bg-dark: #374151;
    --transition: all 0.3s ease-in-out;
    --card-radius: 16px;
    --saturation: 150%;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Inter', sans-serif;
}

body {
    transition: var(--transition);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

/* --- DEVELOPER NOTE: LIQUID GLASS COLOR ---
The variable `--c-glass` defines the base color of the glass effect.
- In light-theme, it's white (`#ffffff`).
- In dark-theme, it's a dark gray (`#222222`).
You can change these values to any color (e.g., a semi-transparent blue) to tint the glass.
The actual transparency is set on the `.liquid-glass` elements themselves using `color-mix`.
*/
body.light-theme {
    background-color: var(--bg-light);
    color: var(--text-light);
    --accent-color: var(--accent-light);
    --btn-bg: var(--btn-bg-light);
    --c-glass: #ffffff; /* Light glass color */
    --c-light: #fff;
    --c-dark: #000;
    --glass-reflex-dark: 1;
    --glass-reflex-light: 1;
}

body.dark-theme {
    background-color: var(--bg-dark);
    color: var(--text-dark);
    --accent-color: var(--accent-dark);
    --btn-bg: var(--btn-bg-dark);
    --c-glass: #222222; /* Dark glass color */
    --c-light: #fff;
    --c-dark: #000;
    --glass-reflex-dark: 2;
    --glass-reflex-light: 0.3;
}

.container {
    max-width: 1200px;
    width: 100%;
    margin: 0 auto;
    padding: 2rem 1.5rem;
    flex: 1;
}

header {
    padding: 0.25rem 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid;
    backdrop-filter: blur(10px);
    position: sticky;
    top: 0;
    z-index: 100;
}

.light-theme header {
    background-color: rgba(255, 255, 255, 0.8);
    border-color: var(--border-light);
}

.dark-theme header {
    background-color: rgba(31, 31, 31, 0.8);
    border-color: var(--border-dark);
}

.logo {
    display: flex;
    align-items: center;
    cursor: pointer;
}

.logo img {
    height: 50px; 
    display: none;
}

.light-theme .logo .logo-light {
    display: block;
}

.dark-theme .logo .logo-dark {
    display: block;
}

.header-right {
    display: flex;
    align-items: center;
    gap: 0.5rem; /* Adjusted gap */
}

.header-icon-btn {
    background: transparent;
    border: none;
    cursor: pointer;
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s ease, transform 0.3s ease;
    padding: 0;
    color: inherit;
}
.header-icon-btn:hover {
    background-color: rgba(128, 128, 128, 0.1);
}
.header-icon-btn svg {
    stroke: currentColor;
    fill: none;
    transition: transform 0.3s ease;
}

/* Animated Hamburger Menu */
.menu-btn svg {
    width: 28px;
    height: 28px;
}
.menu-btn .line {
    fill: none;
    stroke: currentColor;
    stroke-width: 5; /* Bolder lines */
    stroke-linecap: round;
    transition: transform 0.4s, opacity 0.2s;
    transform-origin: center;
}
.menu-btn.active .top {
    transform: translateY(21px) rotate(45deg);
}
.menu-btn.active .middle {
    opacity: 0;
}
.menu-btn.active .bottom {
    transform: translateY(-21px) rotate(-45deg);
}


/* Search Icon */
#searchBtn svg {
    width: 24px;
    height: 24px;
}
#searchBtn:hover svg {
    transform: scale(1.1);
}


.settings-btn svg {
  display: block;
  width: 24px;
  height: 24px;
}

.settings-btn:hover, .settings-btn:focus {
    transform: rotate(90deg);
}
.settings-btn:active {
    transform: rotate(180deg);
}

#topSearchContainer {
    position: absolute;
    top: calc(100% + 10px);
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 600px;
    z-index: 101;
}


.nav-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
    z-index: 1050;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
}
.nav-overlay.active {
    opacity: 1;
    pointer-events: all;
}
.nav-menu {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    text-align: center;
    transition: var(--transition);
}
.nav-link {
    color: white;
    text-decoration: none;
    font-size: 2rem;
    font-weight: 600;
    transition: transform 0.2s ease, color 0.2s ease;
    cursor: pointer;
}
.nav-link:hover {
    transform: scale(1.1);
    color: var(--accent-color);
}
.nav-link.active {
    color: var(--accent-color);
}

/* --- DEVELOPER NOTE: LIQUID GLASS OPACITY ---
The `background-color` property below uses `color-mix` to set the transparency.
`color-mix(in srgb, var(--c-glass) 60%, transparent)`
To make the glass more/less transparent, change `60%`.
e.g., `20%` is more transparent, `80%` is more opaque.
This rule applies to both the Nav Menu and Settings modal.
*/
.nav-menu.liquid-glass {
    padding: 2rem;
    border-radius: var(--card-radius);
    width: 90%;
    max-width: 500px;
    background-color: color-mix(in srgb, var(--c-glass) 60%, transparent); /* Light mode default 60% */
    backdrop-filter: blur(8px) url(#glass-distortion) saturate(var(--saturation));
    -webkit-backdrop-filter: blur(8px) url(#glass-distortion) saturate(var(--saturation));
    box-shadow: inset 0 0 0 1px color-mix(in srgb,var(--c-light) calc(var(--glass-reflex-light) * 10%),transparent),inset 1.8px 3px 0px -2px color-mix(in srgb, var(--c-light) calc(var(--glass-reflex-light) * 90%), transparent),inset -2px -2px 0px -2px color-mix(in srgb, var(--c-light) calc(var(--glass-reflex-light) * 80%), transparent),inset -3px -8px 1px -6px color-mix(in srgb, var(--c-light) calc(var(--glass-reflex-light) * 60%), transparent),inset -0.3px -1px 4px 0px color-mix(in srgb,var(--c-dark) calc(var(--glass-reflex-dark) * 12%),transparent),inset -1.5px 2.5px 0px -2px color-mix(in srgb,var(--c-dark) calc(var(--glass-reflex-dark) * 20%),transparent),inset 0px 3px 4px -2px color-mix(in srgb, var(--c-dark) calc(var(--glass-reflex-dark) * 20%), transparent),inset 2px -6.5px 1px -4px color-mix(in srgb,var(--c-dark) calc(var(--glass-reflex-dark) * 10%),transparent),0px 1px 5px 0px color-mix(in srgb,var(--c-dark) calc(var(--glass-reflex-dark) * 10%),transparent),0px 6px 16px 0px color-mix(in srgb,var(--c-dark) calc(var(--glass-reflex-dark) * 8%),transparent);
}
.dark-theme .nav-menu.liquid-glass {
     background-color: color-mix(in srgb, var(--c-glass) 25%, transparent); /* Dark mode override 25% */
}

.nav-menu.liquid-glass .nav-link {
    color: var(--text-light); /* Default to dark text */
}
.dark-theme .nav-menu.liquid-glass .nav-link {
    color: var(--text-dark); /* Light text on dark theme */
}
.nav-menu.liquid-glass .nav-link:hover {
     color: var(--accent-color);
}
.nav-menu.liquid-glass .nav-link.active {
     color: var(--accent-color);
}

.page-section {
    display: none;
}
.page-section.active {
    display: block;
    animation: fadeIn 0.5s ease-in-out;
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.main-clock {
    text-align: center;
    padding: 2rem;
    border-radius: var(--card-radius);
    margin-bottom: 2rem;
    transition: var(--transition);
    cursor: pointer; /* For fullscreen toggle */
}
.main-clock .date {
    transition: color 0.2s ease;
}

.light-theme .main-clock {
    background-color: var(--card-bg-light);
    box-shadow: var(--shadow-light);
}

.dark-theme .main-clock {
    background-color: var(--card-bg-dark);
    box-shadow: var(--shadow-dark);
}

.main-clock:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.15);
}
.dark-theme .main-clock:hover {
    box-shadow: 0 12px 30px rgba(0,0,0,0.4);
}

.main-clock .time {
    font-size: clamp(3rem, 12vw, 6rem);
    font-weight: 700;
    letter-spacing: -2px;
    font-variant-numeric: tabular-nums; 
}

.main-clock .location {
    font-size: 1rem;
    opacity: 0.6;
    margin-top: 0.5rem;
}

.search-container {
    position: relative;
    max-width: 600px;
    margin: 0 auto 2rem auto;
    transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s;
    z-index: 1; /* Fix for dropdown issue */
}
.search-container:not(.active) {
    opacity: 0;
    transform: translateY(-10px) scale(0.98);
    visibility: hidden;
    pointer-events: none;
}
.search-container.active {
    opacity: 1;
    transform: translateY(0) scale(1);
    visibility: visible;
}

.search-input {
    width: 100%;
    padding: 1rem 1.5rem;
    border-radius: 50px;
    border: 1px solid;
    font-size: 1rem;
    transition: var(--transition);
}

.light-theme .search-input {
    background-color: var(--card-bg-light);
    color: var(--text-light);
    border-color: var(--border-light);
}

.dark-theme .search-input {
    background-color: var(--card-bg-dark);
    color: var(--text-dark);
    border-color: var(--border-dark);
}

.search-input:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
}

.search-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    max-height: 300px;
    overflow-y: auto;
    border-radius: 12px;
    z-index: 101;
    margin-top: 0.5rem;
    display: none;
}

.light-theme .search-dropdown {
    background-color: var(--card-bg-light);
    box-shadow: var(--shadow-light);
}

.dark-theme .search-dropdown {
    background-color: var(--card-bg-dark);
    box-shadow: var(--shadow-dark);
}

.search-dropdown.active {
    display: block;
}

.search-dropdown-item {
    padding: 0.75rem 1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    transition: background-color 0.2s ease;
}

.search-dropdown-item:hover {
    background-color: rgba(212, 175, 55, 0.1);
}

.search-dropdown-item .flag { font-size: 1.5rem; }
.search-dropdown-item .city-name { font-weight: 500; }
.search-dropdown-item .timezone { font-size: 0.8rem; opacity: 0.7; margin-left: auto; }

/* Search Layout Styles */
body.middle-search-layout #searchBtn,
body.middle-search-layout #topSearchContainer {
    display: none;
}
body.top-search-layout #searchContainer {
    display: none;
}

.clocks-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.clock-card {
    padding: 1.5rem;
    border-radius: var(--card-radius);
    transition: var(--transition);
    position: relative;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.clock-card:hover {
    transform: translateY(-5px);
}

.clock-card.card-day {
    background-color: var(--card-bg-light);
    color: var(--text-light);
    box-shadow: var(--shadow-light);
}
.clock-card.card-day:hover {
    box-shadow: 0 12px 30px rgba(0,0,0,0.15);
}

.clock-card.card-night {
    background-color: var(--card-bg-dark);
    color: var(--text-dark);
    box-shadow: var(--shadow-dark);
}
.clock-card.card-night:hover {
    box-shadow: 0 12px 30px rgba(0,0,0,0.4);
}


.clock-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.clock-card-title .flag { font-size: 1.5rem; margin-right: 0.5rem; }
.clock-card-title .city-name { font-size: 1.2rem; font-weight: 600; }

.remove-card-btn {
    position: absolute;
    top: -10px;
    right: -10px;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    font-weight: bold;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    opacity: 0;
    transform: scale(0.5);
    transition: opacity 0.2s ease, transform 0.2s ease;
}
.card-day .remove-card-btn {
    background-color: #e74c3c;
    color: white;
}
.card-night .remove-card-btn {
    background-color: #c0392b;
    color: white;
}
.clock-card:hover .remove-card-btn {
    opacity: 1;
    transform: scale(1);
}

.clock-card .time { 
    font-size: 2.2rem; 
    font-weight: 500; 
    font-variant-numeric: tabular-nums;
}
.clock-card .date { font-size: 0.9rem; opacity: 0.8; }

.time-difference {
    font-size: 0.8rem;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    display: inline-block;
    font-weight: 500;
    margin-top: 0.25rem;
    background-color: rgba(128, 128, 128, 0.1);
}

.card-night .time-difference {
     background-color: rgba(255, 255, 255, 0.1);
}

.day-night-indicator {
    position: absolute;
    top: 1rem;
    right: 1rem;
    font-size: 1.2rem;
}

.section {
     margin-bottom: 2rem;
}

.section-title {
    font-size: 1.5rem;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid;
}
.light-theme .section-title { border-color: var(--border-light); }
.dark-theme .section-title { border-color: var(--border-dark); }

#popular-cities-container {
    background-color: #1a1a1a;
    color: #d1d5db;
    padding: 2rem;
    border-radius: var(--card-radius);
    text-align: center;
}
#city-cloud {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    gap: 0.5rem 1rem;
}
.city-item, .timezone-item {
    cursor: pointer;
    padding: 0.25rem 0.5rem;
    border-radius: 0.375rem;
    transition: background-color 0.3s ease, color 0.3s ease;
    line-height: 1.5;
    display: inline-block;
}
.city-item:hover, .timezone-item:hover {
    background-color: #ffffff;
    color: #000000 !important;
}
.timezone-controls {
    margin-top: 2rem;
    text-align: center;
}
.timezone-controls .timezone-item {
    font-size: 0.875rem;
    color: #9ca3af;
}
.city-item.size-1 { font-size: 0.9rem; font-weight: 400; color: #9ca3af; }
.city-item.size-2 { font-size: 1rem; font-weight: 500; color: #d1d5db; }
.city-item.size-3 { font-size: 1.25rem; font-weight: 600; color: #e5e7eb; }
.city-item.size-4 { font-size: 1.5rem; font-weight: 700; color: #f9fafb; }
.city-item.size-5 { font-size: 1.875rem; font-weight: 800; color: #ffffff; }

textarea {
    width: 100%;
    min-height: 120px;
    padding: 1rem;
    border-radius: var(--card-radius);
    border: 1px solid;
    font-size: 1rem;
    resize: vertical;
    transition: var(--transition);
}
.light-theme textarea { background-color: var(--card-bg-light); color: var(--text-light); border-color: var(--border-light); }
.dark-theme textarea { background-color: var(--card-bg-dark); color: var(--text-dark); border-color: var(--border-dark); }
textarea:focus { outline: none; border-color: var(--accent-color); }

.calendar {
    border-radius: var(--card-radius);
    overflow: hidden;
    transition: var(--transition);
}
.light-theme .calendar { background-color: var(--card-bg-light); box-shadow: var(--shadow-light); }
.dark-theme .calendar { background-color: var(--card-bg-dark); box-shadow: var(--shadow-dark); }

.calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    background-color: rgba(0,0,0,0.1);
}
.dark-theme .calendar-header {
    background-color: rgba(255,255,255,0.05);
}


.calendar-title-text {
    font-weight: 600; font-size: 1.1rem;
    cursor: pointer;
    transition: opacity 0.2s;
    background: var(--btn-bg);
    color: inherit;
    padding: 0.5rem 1rem;
    border-radius: 8px;
}
.calendar-title-text:hover {
    opacity: 0.8;
}

.calendar-nav { display: flex; gap: 0.5rem; }
.calendar-nav-btn { background: none; border: none; color: inherit; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: background-color 0.2s ease; }
.calendar-nav-btn:hover { background-color: rgba(128, 128, 128, 0.1); }

.calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); padding: 1rem; gap: 0.5rem; }
.calendar-day-header { text-align: center; font-weight: 600; font-size: 0.8rem; opacity: 0.7; }
.calendar-day { 
    text-align: center; padding: 0.5rem; cursor: pointer; border-radius: 50%; 
    width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; 
    margin: 0 auto; transition: background-color 0.2s ease;
    position: relative;
}
.calendar-day:hover { background-color: rgba(212, 175, 55, 0.1); }
.calendar-day.selected {
    box-shadow: 0 0 0 2px var(--accent-color);
}
.calendar-day.today { background-color: var(--accent-color); color: white; font-weight: 600; }
.calendar-day.other-month { opacity: 0.3; }
.calendar-day.has-note::after {
    content: '';
    position: absolute;
    bottom: 4px;
    left: 50%;
    transform: translateX(-50%);
    width: 5px;
    height: 5px;
    border-radius: 50%;
    background-color: var(--accent-color);
}
.calendar-day.today.has-note::after {
    background-color: white;
}

.recent-notes-container {
    display: flex;
    gap: 0.25rem;
    margin-left: 0.75rem; /* Space from title */
    flex-grow: 1; /* Take up space */
    flex-wrap: wrap; /* Wrap if many notes */
}
.note-circle {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background-color: var(--accent-color);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s ease;
}
.note-circle:hover {
    transform: scale(1.1);
}
.dark-theme .note-circle {
    color: #333;
}

/* --- Sound Player Styles --- */
.sounds-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    padding: 0;
    margin-top: 1.5rem;
    flex-wrap: wrap;
}
.sound-btn {
    background: none;
    border: 2px solid;
    color: inherit;
    width: 70px;
    height: 70px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 0.25rem;
    transition: var(--transition);
    font-size: 0.75rem;
    font-weight: 500;
    opacity: 0.7;
}
.light-theme .sound-btn {
    border-color: var(--border-light);
}
.dark-theme .sound-btn {
    border-color: var(--border-dark);
}
.sound-btn:hover {
    opacity: 1;
    border-color: var(--accent-color);
}
.sound-btn.active {
    background-color: #3b82f6; /* Blue background for active state */
    color: white;
    border-color: #3b82f6;
    opacity: 1;
}
.sound-btn img {
    width: 28px;
    height: 28px;
    pointer-events: none; /* Make sure clicks go to the button */
    transition: filter 0.3s ease-in-out;
}

/* In dark mode, make the icons white */
.dark-theme .sound-btn:not(.active) img {
    filter: invert(1);
}

/* When active, the icon should always be white, against the blue background */
.sound-btn.active img {
    filter: brightness(0) invert(1);
}

.action-buttons-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem;
}
.action-btn {
    color: white;
    border: none;
    padding: 0.75rem 2rem;
    border-radius: 50px;
    cursor: pointer;
    transition: background-color 0.2s ease;
    font-weight: 500;
    background-color: var(--btn-bg);
    color: inherit;
}
.light-theme .action-btn { color: #374151; }
.dark-theme .action-btn { color: #e5e7eb; }


.reset-btn {
    background-color: #22c55e;
}
.reset-btn:hover { background-color: #16a34a; }
.refresh-btn:hover {
    opacity: 0.8;
}
.refresh-btn:disabled {
    background-color: #95a5a6;
    cursor: not-allowed;
}
.all-notes-btn:hover {
    opacity: 0.8;
}


footer {
    padding: 2rem 1.5rem;
    background-color: white;
}

.light-theme .site-footer {
    background-color: var(--bg-light);
    color: #4b5563;
}
.dark-theme .site-footer {
    background-color: var(--card-bg-dark);
    color: #9ca3af;
}

.site-footer {
    padding: 3rem 1.5rem;
}
.footer-container {
    max-width: 1200px;
    margin: 0 auto;
}
.footer-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem; /* Reduced from 2rem */
    padding-bottom: 2rem;
    border-bottom: 1px solid;
}
.light-theme .footer-top { border-color: var(--border-light); }
.dark-theme .footer-top { border-color: var(--border-dark); }

/* --- DEVELOPER NOTE: FOOTER LOGO SIZE ---
Adjust the `height` property below to resize the main footer logo.
*/
.footer-logo img {
    height: 60px;
    display: none;
}
.light-theme .footer-logo .logo-light {
    display: block;
}
.dark-theme .footer-logo .logo-dark {
    display: block;
}

/* --- DEVELOPER NOTE: FOOTER LOGO SIZE ---
Adjust the `height` property below to resize the "Product of TIGOTEK" logo.
*/
.app-store-btn img {
    height: 70px;
}

.footer-links {
    display: none; /* Hide all footer links */
}

.footer-bottom {
    font-size: 0.875rem;
    opacity: 0.8;
    text-align: center;
}
.footer-bottom p {
    margin-bottom: 0.5rem;
}
.footer-bottom a {
    color: var(--accent-color);
    text-decoration: none;
}
.footer-bottom a:hover {
    text-decoration: underline;
}

.footer-credit {
    text-align: center;
    margin-top: 2rem;
    font-size: 0.8rem;
    opacity: 0.7;
}
.footer-credit p {
    margin-bottom: 0.25rem;
}
.footer-credit a {
    color: inherit;
    text-decoration: none;
}
.footer-credit a:hover {
    text-decoration: underline;
    color: var(--accent-color); /* Add hover color */
}
.footer-credit .footer-tigotek-link {
    font-style: italic;
    font-weight: bold;
    color: var(--accent-color);
    text-decoration: none;
}
.footer-credit .footer-tigotek-link:hover {
    color: #888; /* Gray on hover */
    text-decoration: none;
}


.quote-wrapper {
    padding: 2rem 1.5rem;
    background-color: var(--card-bg-light);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 140px;
}

.quote-container {
    text-align: center;
    max-width: 800px;
    margin: 0 auto;
}
.quote {
    font-family: 'Roboto Mono', monospace;
    font-style: italic;
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 0.5rem;
    color: #333;
}

.quote-author {
    font-family: 'Inter', sans-serif;
    font-size: 1rem;
    color: #555;
}


.quote-container .cursor {
    display: inline-block;
    background-color: #333;
    margin-left: 2px;
    width: 3px;
    height: 1.2rem;
    animation: blink 1s infinite;
}

.modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(5px);
    display: flex; justify-content: center; align-items: center;
    z-index: 1000; opacity: 0; pointer-events: none; transition: opacity 0.3s ease;
}
.modal-overlay.active { opacity: 1; pointer-events: all; }

.modal-content {
    width: 90%; max-width: 500px; border-radius: var(--card-radius);
    padding: 2rem; position: relative; transition: transform 0.3s ease;
    transform: scale(0.95);
    max-height: 80vh; 
    display: flex; 
    flex-direction: column;
}
.modal-overlay.active .modal-content { transform: scale(1); }

.modal-content.liquid-glass {
    background-color: color-mix(in srgb, var(--c-glass) 60%, transparent); /* Light mode default 60% */
    backdrop-filter: blur(8px) url(#glass-distortion) saturate(var(--saturation));
    -webkit-backdrop-filter: blur(8px) url(#glass-distortion) saturate(var(--saturation));
    box-shadow: inset 0 0 0 1px color-mix(in srgb,var(--c-light) calc(var(--glass-reflex-light) * 10%),transparent),inset 1.8px 3px 0px -2px color-mix(in srgb, var(--c-light) calc(var(--glass-reflex-light) * 90%), transparent),inset -2px -2px 0px -2px color-mix(in srgb, var(--c-light) calc(var(--glass-reflex-light) * 80%), transparent),inset -3px -8px 1px -6px color-mix(in srgb, var(--c-light) calc(var(--glass-reflex-light) * 60%), transparent),inset -0.3px -1px 4px 0px color-mix(in srgb,var(--c-dark) calc(var(--glass-reflex-dark) * 12%),transparent),inset -1.5px 2.5px 0px -2px color-mix(in srgb,var(--c-dark) calc(var(--glass-reflex-dark) * 20%),transparent),inset 0px 3px 4px -2px color-mix(in srgb, var(--c-dark) calc(var(--glass-reflex-dark) * 20%), transparent),inset 2px -6.5px 1px -4px color-mix(in srgb,var(--c-dark) calc(var(--glass-reflex-dark) * 10%),transparent),0px 1px 5px 0px color-mix(in srgb,var(--c-dark) calc(var(--glass-reflex-dark) * 10%),transparent),0px 6px 16px 0px color-mix(in srgb,var(--c-dark) calc(var(--glass-reflex-dark) * 8%),transparent);
    color: var(--text-light); /* Default dark text */
}
.dark-theme .modal-content.liquid-glass {
    background-color: color-mix(in srgb, var(--c-glass) 25%, transparent); /* Dark mode override 25% */
    color: var(--text-dark); /* Light text on dark theme */
}


.light-theme .modal-content:not(.liquid-glass) { background-color: var(--card-bg-light); }
.dark-theme .modal-content:not(.liquid-glass) { background-color: var(--card-bg-dark); }

.modal-header {
    flex-shrink: 0;
    display: flex;
    justify-content: flex-start;
    align-items: center;
    position: relative;
    padding-right: 3rem; /* Make space for close btn */
    gap: 0.75rem; /* Space between title and download button */
}
.modal-header h2 {
    flex-grow: 0;
}

.download-notes-btn {
    padding: 0.5rem;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    line-height: 1;
    flex-shrink: 0; /* Prevent button from shrinking */
}
.download-notes-btn svg {
    margin: 0; /* Center icon */
    width: 18px;
    height: 18px;
}


.modal-body {
    overflow-y: auto; 
    flex-grow: 1;
    margin-top: 1rem;
}


.close-modal-btn {
    position: absolute; top: 1rem; right: 1rem; font-size: 1.5rem;
    cursor: pointer; width: 30px; height: 30px; display: flex;
    align-items: center; justify-content: center; border-radius: 50%;
    transition: var(--transition);
    background: none; border: none;
    color: inherit;
}
.close-modal-btn:hover { background-color: rgba(128, 128, 128, 0.1); transform: rotate(90deg); }

#allNotesContent .note-entry {
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid;
}
.light-theme #allNotesContent .note-entry { border-color: var(--border-light); }
.dark-theme #allNotesContent .note-entry { border-color: var(--border-dark); }
#allNotesContent .note-entry:last-child {
    border-bottom: none;
    margin-bottom: 0;
}
.note-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}
.note-date {
    font-weight: 600;
    color: var(--accent-color);
}
.note-action-btn {
    background: var(--btn-bg);
    color: inherit;
    border: none;
    padding: 0.3rem 0.6rem;
    font-size: 0.8rem;
    border-radius: 6px;
    cursor: pointer;
}
.note-action-btn:hover {
    opacity: 0.8;
}
.save-note-btn {
    background-color: #22c55e;
    color: white;
}
.note-text-edit {
    width: 100%;
    min-height: 100px;
    resize: vertical;
    padding: 0.5rem;
    border-radius: 6px;
    border: 1px solid var(--border-light);
    font-family: 'Inter', sans-serif;
    font-size: 1rem;
}
.light-theme .note-text-edit {
    background-color: var(--card-bg-light);
    color: var(--text-light);
    border-color: var(--border-light);
}
.dark-theme .note-text-edit {
    background-color: var(--card-bg-dark);
    color: var(--text-dark);
    border-color: var(--border-dark);
}

#allNotesContent .note-text {
    white-space: pre-wrap;
    word-wrap: break-word;
}

#datePickerModal .modal-content {
    max-width: 400px;
    background-color: #2c3e50;
    color: #ecf0f1;
}
.date-picker-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}
.date-picker-year-selector {
    display: flex;
    align-items: center;
    gap: 1rem;
}
.year-nav-btn {
    background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;
}
.year-input {
    font-size: 1.5rem; font-weight: 600;
    background: none;
    border: none;
    border-bottom: 2px solid rgba(255,255,255,0.5);
    color: white;
    width: 70px;
    text-align: center;
    padding: 0.25rem;
}
.year-input:focus {
    outline: none;
    border-bottom-color: var(--accent-color);
}
.year-input::-webkit-outer-spin-button,
.year-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}
.year-input[type=number] {
    -moz-appearance: textfield;
}

.date-picker-months-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
}
.month-btn {
    background: none;
    border: 2px solid transparent;
    color: #ecf0f1;
    padding: 0.75rem;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.2s, border-color 0.2s;
    font-size: 1rem;
    font-weight: 500;
}
.month-btn:hover {
    background-color: rgba(255, 255, 255, 0.1);
}
.month-btn.active {
    background-color: var(--accent-color);
    border-color: var(--accent-color);
}

.fullscreen-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: black;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    z-index: 200; opacity: 0; pointer-events: none; transition: opacity 0.3s ease;
    overflow: hidden;
    cursor: pointer;
}
.fullscreen-overlay.active { opacity: 1; pointer-events: all; }

.fullscreen-overlay .time,
.fullscreen-overlay .date {
    font-variant-numeric: tabular-nums;
    pointer-events: none;
    color: rgba(230, 230, 230, 0.9); /* Base color */
    text-shadow: 
        /* Top highlight */
        0 -1px 1px rgba(255, 255, 255, 0.5),
        /* Bottom shadow for depth */
        0 2px 3px rgba(0, 0, 0, 0.5),
        /* Subtle overall blur/glow */
        0 0 5px rgba(255, 255, 255, 0.3),
        0 0 15px rgba(255, 255, 255, 0.2);
}

.fullscreen-overlay .time { 
    font-size: clamp(4rem, 20vw, 12rem); 
    font-weight: 800; /* Bolder for better effect */
}
.fullscreen-overlay .date { 
    font-size: clamp(1.5rem, 6vw, 3rem); 
    opacity: 0.9;
    font-weight: 500;
}

.fullscreen-hint {
    position: absolute;
    bottom: 30px;
    background-color: rgba(0, 0, 0, 0.5);
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 0.9rem;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
    pointer-events: none;
}
.fullscreen-hint.visible {
    opacity: 1;
}


/* --- Focus Mode Styles --- */
.video-background-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1; 
    opacity: 0;
    transition: opacity 0.5s ease;
    overflow: hidden;
}

.video-background-container video {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100vw;
    height: 56.25vw; /* 16:9 aspect ratio */
    min-height: 100vh;
    min-width: 177.77vh; /* 16:9 aspect ratio */
    transform: translate(-50%, -50%);
    pointer-events: none; 
}

.fullscreen-overlay.focus-active .video-background-container {
    opacity: 0.3; /* Make it a subtle background */
}

.settings-group { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid; }
.light-theme .settings-group { border-color: var(--border-light); }
.dark-theme .settings-group { border-color: var(--border-dark); }
.settings-group:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }

.settings-group h3 { margin-bottom: 1rem; font-size: 1.2rem; color: var(--accent-color); }
.setting-row { margin-top: 1rem; display: flex; align-items: center; justify-content: space-between; }

.toggle-switch { position: relative; display: inline-block; width: 50px; height: 28px; }
.toggle-switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 28px; }
.slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
input:checked + .slider { background-color: var(--accent-color); }
input:checked + .slider:before { transform: translateX(22px); }

.language-select {
    width: 100%; padding: 0.75rem; border-radius: 8px;
    border: 1px solid; font-size: 1rem;
}
.light-theme .language-select { background-color: var(--card-bg-light); color: var(--text-light); border-color: var(--border-light); }
.dark-theme .language-select { background-color: var(--card-bg-dark); color: var(--text-dark); border-color: var(--border-dark); }

.utility-container {
    max-width: 600px;
    margin: 2rem auto;
    padding: 2rem;
    border-radius: var(--card-radius);
}
.light-theme .utility-container {
    background-color: var(--card-bg-light);
    box-shadow: var(--shadow-light);
}
.dark-theme .utility-container {
    background-color: var(--card-bg-dark);
    box-shadow: var(--shadow-dark);
}

.utility-display {
    font-family: 'Roboto Mono', monospace;
    font-size: clamp(3rem, 12vw, 5rem);
    text-align: center;
    font-weight: 700;
    margin-bottom: 1.5rem;
    font-variant-numeric: tabular-nums;
}
.utility-display .milliseconds {
    font-size: 0.5em;
    color: var(--accent-color);
}

.utility-controls {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
}
.utility-btn {
    padding: 0.75rem 1.5rem;
    font-size: 1rem;
    font-weight: 600;
    border-radius: 50px;
    border: none;
    cursor: pointer;
    transition: var(--transition);
    min-width: 100px; 
    background-color: var(--btn-bg);
    color: inherit;
}
.light-theme .utility-btn { color: #374151; }
.dark-theme .utility-btn { color: #e5e7eb; }

.utility-btn.start-btn { background-color: #22c55e; color: white; }
.utility-btn.start-btn:hover { background-color: #16a34a; }
.utility-btn.stop-btn { background-color: #ef4444; color: white; }
.utility-btn.stop-btn:hover { background-color: #dc2626; }
.utility-btn:hover {
    opacity: 0.8;
}

.laps-list, .alarms-list {
    list-style: none;
    padding: 0;
    max-height: 3000px;
    overflow-y: auto;
}
.lap-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 1rem;
    border-bottom: 1px solid;
    font-family: 'Roboto Mono', monospace;
}
.light-theme .lap-item { border-color: var(--border-light); }
.dark-theme .lap-item { border-color: var(--border-dark); }
.lap-item:last-child { border-bottom: none; }
.lap-number { font-weight: bold; }

.timer-inputs {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
}
.timer-input-group {
    display: flex;
    flex-direction: column;
    align-items: center;
}
.timer-input-group label {
    font-size: 0.8rem;
    margin-bottom: 0.25rem;
    opacity: 0.7;
}
.timer-input {
    width: 80px;
    padding: 0.5rem;
    font-size: 1.5rem;
    text-align: center;
    border-radius: 8px;
    border: 1px solid;
}
.light-theme .timer-input { background-color: var(--card-bg-light); border-color: var(--border-light); }
.dark-theme .timer-input { background-color: #1a2639; border-color: var(--border-dark); color: var(--text-dark); }

.add-alarm-form {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    justify-content: center;
}
.alarm-inputs {
    display: flex;
    gap: 1rem;
    flex-grow: 1;
    min-width: 250px; /* Prevent wrapping on small screens */
}
.alarm-inputs input {
    flex-grow: 1;
    padding: 0.75rem;
    border-radius: 8px;
    border: 1px solid;
}
.alarm-add-button {
     width: 100%;
     display: flex;
     justify-content: center;
}
.light-theme .alarm-inputs input { background-color: var(--card-bg-light); border-color: var(--border-light); }
.dark-theme .alarm-inputs input { background-color: #1a2639; border-color: var(--border-dark); color: var(--text-dark); }
.add-alarm-btn {
    background-color: var(--accent-color);
    color: white;
}

.alarm-item {
    padding: 0;
    border: none;
    border-bottom: 1px solid;
}
.light-theme .alarm-item { border-color: var(--border-light); }
.dark-theme .alarm-item { border-color: var(--border-dark); }
.alarm-item:last-child {
    border-bottom: none;
}

.alarm-card {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 0;
    transition: var(--transition);
}
.light-theme .alarm-card.disabled { background-color: transparent; }
.dark-theme .alarm-card.disabled { background-color: transparent; }

.alarm-card-details {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    flex-grow: 1;
}
.alarm-card-time {
    font-family: 'Roboto Mono', monospace;
    font-size: 2rem;
    font-weight: 500;
}
.alarm-card-label {
    font-size: 1rem;
    opacity: 0.8;
}
.alarm-countdown {
    font-family: 'Roboto Mono', monospace;
    font-size: 0.85rem;
    color: var(--accent-color);
    margin-top: 0.5rem;
    min-height: 1.2em; 
}
.alarm-card-controls {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-shrink: 0;
}
.delete-alarm-btn {
    background: none;
    border: none;
    color: #e74c3c;
    cursor: pointer;
    font-size: 1.5rem;
    transition: transform 0.2s ease;
}
.delete-alarm-btn:hover {
    transform: scale(1.1);
}
.alarm-card.disabled {
    opacity: 0.6;
}
.alarm-card.disabled .alarm-card-time,
.alarm-card.disabled .alarm-card-label {
    text-decoration: line-through;
}
    </style>
</head>
<body>
    <header>
        <div class="logo" id="logoLink">
            <img src="LOGOBlack H.png" alt="AIRCLOCK Logo" class="logo-light">
            <img src="LOGOWhite H.png" alt="AIRCLOCK Logo" class="logo-dark">
        </div>
        <div class="header-right">
             <button class="header-icon-btn" id="searchBtn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
            </button>
            <button class="header-icon-btn menu-btn" id="menuBtn">
                <svg viewBox="0 0 100 100">
                    <path class="line top" d="M 20,29 H 80" />
                    <path class="line middle" d="M 20,50 H 80" />
                    <path class="line bottom" d="M 20,71 H 80" />
                </svg>
            </button>
            <button class="header-icon-btn settings-btn" id="settingsBtn">
              <svg xmlns="http://www.w3.org/2000/svg" 
                   width="24" height="24" viewBox="0 0 24 24" 
                   fill="none" stroke="currentColor" 
                   stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82 2 2 0 1 1-2.83 2.83 1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51A2 2 0 1 1 9.9 21 a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33 2 2 0 1 1-2.83-2.83 1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1A2 2 0 1 1 3 9.9 a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82 2 2 0 1 1 2.83-2.83 1.65 1.65 0 0 0 1.82.33 1.65 1.65 0 0 0 1-1.51A2 2 0 1 1 14.1 3 a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33 2 2 0 1 1 2.83 2.83 1.65 1.65 0 0 0-.33 1.82 1.65 1.65 0 0 0 1.51 1A2 2 0 1 1 21 14.1 a1.65 1.65 0 0 0-1.51 1z"></path>
              </svg>
            </button>
        </div>
        <div id="topSearchContainer" class="search-container">
            <input type="text" class="search-input city-search-input" placeholder="Search for a city or country...">
            <div class="search-dropdown"></div>
        </div>
    </header>

    <div class="nav-overlay" id="navOverlay">
        <nav class="nav-menu" id="navMenu">
            <a class="nav-link" data-page="time">Time</a>
            <a class="nav-link" data-page="stopwatch">Stopwatch</a>
            <a class="nav-link" data-page="timer">Timer</a>
            <a class="nav-link" data-page="alarm">Alarm</a>
        </nav>
    </div>

    <div class="container">
        <div id="page-time" class="page-section active">
            <div class="main-clock" id="mainClockContainer">
                <div class="time" id="mainTime">--:--:--</div>
                <div class="date" id="mainDate">Loading...</div>
                <div class="location" id="mainLocation"></div>
                <div class="sounds-container" id="soundsContainer">
                    <button class="sound-btn" data-audio="https://res.cloudinary.com/dhkjgite9/video/upload/v1761056029/Rain_f1od5r.mp3" data-video="https://res.cloudinary.com/dhkjgite9/video/upload/v1761223281/rain2_oo07o3.mov">
                        <img src="rain.svg" alt="Rain icon">
                        <span>Rain</span>
                    </button>
                    <button class="sound-btn" data-audio="https://res.cloudinary.com/dhkjgite9/video/upload/v1761056020/Forest_uah836.mp3" data-video="https://res.cloudinary.com/dhkjgite9/video/upload/v1761158049/Forest_NO_AUDIO_mihche.mp4">
                        <img src="Forest.svg" alt="Forest icon">
                        <span>Forest</span>
                    </button>
                    <button class="sound-btn" data-audio="https://res.cloudinary.com/dhkjgite9/video/upload/v1761056596/Owl_q6mdbq.mp3" data-video="https://res.cloudinary.com/dhkjgite9/video/upload/v1761158091/Owl_No_Audio_tojgpo.mp4">
                        <img src="OWL.svg" alt="Owl icon">
                        <span>Owl</span>
                    </button>
                    <button class="sound-btn" data-audio="https://res.cloudinary.com/dhkjgite9/video/upload/v1761056237/Focus_emjbto.mp3" data-video="https://res.cloudinary.com/dhkjgite9/video/upload/v1761158057/GALAXY_NO_AUDIO_zrshcb.mp4">
                        <img src="Focus.svg" alt="Focus icon">
                        <span>Focus</span>
                    </button>
                </div>
            </div>

            <div class="search-container" id="searchContainer">
                <input type="text" class="search-input city-search-input" placeholder="Search for a city or country...">
                <div class="search-dropdown"></div>
            </div>

            <div class="clocks-grid" id="clocksGrid"></div>

            <div class="section" id="popular-cities-section">
                <!-- Added ID "popularCitiesTitle" -->
                <h2 class="section-title" id="popularCitiesTitle">Most popular timezones and cities</h2>
                <div id="popular-cities-container">
                    <div id="city-cloud"></div>
                    <div class="timezone-controls">
                        <div class="flex justify-center items-center space-x-4">
                            <span class="timezone-item">UTC</span>
                            <span class="timezone-item">GMT</span>
                            <span class="timezone-item">CET</span>
                        </div>
                        <div class="flex flex-wrap justify-center items-center space-x-4 mt-4">
                            <span class="timezone-item">Pacific Time</span>
                            <span class="timezone-item">Mountain Time</span>
                            <span class="timezone-item">Central Time</span>
                            <span class="timezone-item">Eastern Time</span>
                            <span class="timezone-item">China Standard Time</span>
                            <span class="timezone-item">India Standard Time</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title" id="calendarSectionTitle">Calendar</h2>
                <div class="calendar">
                    <div class="calendar-header">
                        <span class="calendar-title-text" id="calendarTitleText"></span>
                        <div id="recentNotesContainer" class="recent-notes-container"></div>
                        <div class="calendar-nav">
                            <button class="calendar-nav-btn" id="prevMonthBtn">◀</button>
                            <button class="calendar-nav-btn" id="nextMonthBtn">▶</button>
                        </div>
                    </div>
                    <div class="calendar-grid" id="calendarGrid"></div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title" id="notesTitle">Notes</h2>
                <textarea id="notesArea" placeholder="Write something..."></textarea>
            </div>
            
            <div class="section action-buttons-container">
                
                <button class="action-btn" id="showAllNotesBtn">Show All Notes</button>
                <button class="action-btn reset-btn" id="resetBtn">Reset All Data</button>
            </div>
        </div>

        <div id="page-stopwatch" class="page-section">
            <div class="utility-container">
                <h2 class="section-title">Stopwatch</h2>
                <div class="utility-display" id="stopwatchDisplay">00:00:00<span class="milliseconds">.00</span></div>
                <div class="utility-controls">
                    <button class="utility-btn start-btn" id="stopwatchToggleBtn">Start</button>
                    <button class="utility-btn" id="stopwatchLapBtn">Lap</button>
                    <button class="utility-btn" id="stopwatchResetBtn">Reset</button>
                </div>
                <ul class="laps-list" id="lapsList"></ul>
            </div>
        </div>

        <div id="page-timer" class="page-section">
            <div class="utility-container">
                <h2 class="section-title">Timer</h2>
                <div class="utility-display" id="timerDisplay">00:00:00</div>
                <div class="timer-inputs" id="timerInputs">
                    <div class="timer-input-group">
                        <label for="timerHours">Hours</label>
                        <input type="number" id="timerHours" class="timer-input" min="0" max="99" value="0">
                    </div>
                    <div class="timer-input-group">
                        <label for="timerMinutes">Minutes</label>
                        <input type="number" id="timerMinutes" class="timer-input" min="0" max="59" value="10">
                    </div>
                    <div class="timer-input-group">
                        <label for="timerSeconds">Seconds</label>
                        <input type="number" id="timerSeconds" class="timer-input" min="0" max="59" value="0">
                    </div>
                </div>
                <div class="utility-controls">
                    <button class="utility-btn start-btn" id="timerToggleBtn">Start</button>
                    <button class="utility-btn" id="timerResetBtn">Reset</button>
                </div>
            </div>
        </div>

        <div id="page-alarm" class="page-section">
            <div class="utility-container">
                <h2 class="section-title">Alarm</h2>
                <div class="add-alarm-form">
                    <div class="alarm-inputs">
                        <input type="time" id="alarmTimeInput">
                        <input type="text" id="alarmLabelInput" placeholder="Alarm label">
                    </div>
                    <div class="alarm-add-button">
                        <button class="utility-btn add-alarm-btn" id="addAlarmBtn">Add</button>
                    </div>
                </div>
                <ul class="alarms-list" id="alarmsList"></ul>
            </div>
        </div>
    </div>

    <div class="quote-wrapper">
        <div class="quote-container" id="quoteContainer">
            <p class="quote"><span id="quoteText"></span><span class="cursor" style="display: none;">&nbsp;</span></p>
            <p class="quote-author"><span id="quoteAuthor"></span></p>
        </div>
    </div>
     <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-top">
                <div class="footer-logo" id="footerLogoLink">
                    <img src="airclock-footer-black.png" alt="AIRCLOCK Logo" class="logo-light">
                    <img src="airclock-footer-white.png" alt="AIRCLOCK Logo" class="logo-dark">
                </div>
                <a href="https://www.tigotek.net/" target="_blank" rel="noopener noreferrer" class="app-store-btn">
                    <img src="Product of TIGOTEK.png" alt="Product of TIGOTEK">
                </a>
            </div>
            
            <div class="footer-bottom">
                <p style="text-align: left;">Airclock displays exact, official atomic clock time for any time zone (more than 7 million locations) in 58 languages.</p>
                <p style="text-align: left;">
                    <a href="#">What time is it?</a> | <a href="#" id="langLinkBangla">কয়টা বাজে?</a> | <a href="#">Quelle heure est-il ?</a> | <a href="#">Который час?</a> | <a href="#">Que horas são?</a> | <a href="#">Jam berapa?</a> | <a href="#">Wieviel Uhr ist es?</a> | <a href="mailto:info@tigotek.net">Reach Us</a>
                </p>
                <div class="footer-credit">
                    <p>
                        Product of <a href="https://www.tigotek.net" target="_blank" rel="noopener noreferrer" class="footer-tigotek-link">Tigotek</a>
                        © 2025 All rights reserved.
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <div class="fullscreen-overlay" id="fullscreenOverlay">
        <div class="video-background-container" id="focusVideoContainer">
            <video id="fullscreenVideoPlayer" autoplay loop muted playsinline></video>
        </div>
        <div class="time" id="fullscreenTime"></div>
        <div class="date" id="fullscreenDate"></div>
        <div class="fullscreen-hint" id="fullscreenHint">Press Shift+F to go full screen</div>
    </div>

    <div class="modal-overlay" id="datePickerModal">
        <div class="modal-content">
            <div class="date-picker-header">
                <div class="date-picker-year-selector">
                    <button class="year-nav-btn" id="prevYearBtn">◀</button>
                    <input type="number" class="year-input" id="pickerYearInput">
                    <button class="year-nav-btn" id="nextYearBtn">▶</button>
                </div>
                <button class="close-modal-btn" id="closeDatePickerBtn">✕</button>
            </div>
            <div class="date-picker-months-grid" id="datePickerMonthsGrid">
                </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="allNotesModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="allNotesTitle">All Notes</h2>
                <button class="action-btn download-notes-btn" id="downloadNotesBtn" title="Download as .txt">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                </button>
                <button class="close-modal-btn" id="closeAllNotesBtn">✕</button>
            </div>
            <div class="modal-body" id="allNotesContent">
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="settingsModalTitle">Settings</h2>
                <button class="close-modal-btn" id="closeSettingsBtn">✕</button>
            </div>
            <div class="modal-body">
                <div class="settings-group">
                    <h3 id="themeSettingsTitle">Theme</h3>
                    <div class="setting-row">
                        <span id="autoThemeLabel">Auto Theme</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="autoThemeToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-row">
                        <span id="darkThemeLabel">Dark Mode</span>
                        <label class="toggle-switch" id="manualThemeToggleContainer">
                            <input type="checkbox" id="manualThemeToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-group">
                    <h3 id="formatSettingsTitle">Format</h3>
                    <div class="setting-row">
                        <span id="hourFormatLabel">24-Hour Format</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="hourFormatToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                 <div class="settings-group">
                    <h3 id="layoutSettingsTitle">Layout</h3>
                    <div class="setting-row">
                        <span id="searchLayoutLabel">Top Search Bar</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="searchLayoutToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-row">
                        <span id="menuBackgroundLabel">Show Menu Background</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="menuBackgroundToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="settings-group">
                    <h3 id="languageSettingsTitle">Language</h3>
                    <select id="languageSelect" class="language-select">
                        </select>
                </div>
                
                <div class="settings-group">
                     <button class="action-btn" id="refreshCardsBtn" style="width: 100%;">Refresh Cards</button>
                </div>
            </div>
        </div>
    </div>

    <audio id="ambient-audio-player" loop></audio>

    <svg style="display: none">
      <filter
        id="glass-distortion"
        x="0%"
        y="0%"
        width="100%"
        height="100%"
        filterUnits="objectBoundingBox"
      >
        <feTurbulence
          type="fractalNoise"
          baseFrequency="0.01 0.01"
          numOctaves="1"
          seed="5"
          result="turbulence"
        />
        <feComponentTransfer in="turbulence" result="mapped">
          <feFuncR type="gamma" amplitude="1" exponent="10" offset="0.5" />
          <feFuncG type="gamma" amplitude="0" exponent="1" offset="0" />
          <feFuncB type="gamma" amplitude="0" exponent="1" offset="0.5" />
        </feComponentTransfer>
        <feGaussianBlur in="turbulence" stdDeviation="3" result="softMap" />
        <feSpecularLighting
          in="softMap"
          surfaceScale="5"
          specularConstant="1"
          specularExponent="100"
          lighting-color="white"
          result="specLight"
        >
          <fePointLight x="-200" y="-200" z="300" />
        </feSpecularLighting>
        <feComposite
          in="specLight"
          operator="arithmetic"
          k1="0"
          k2="1"
          k3="1"
          k4="0"
          result="litImage"
        />
        <feDisplacementMap
          in="SourceGraphic"
          in2="softMap"
          scale="150"
          xChannelSelector="R"
          yChannelSelector="G"
        />
      </filter>
    </svg>

    <script>
        // --- 1. CONFIGURATION & STATE MANAGEMENT ---
const dom = {
    body: document.body,
    logoLink: document.getElementById('logoLink'),
    footerLogoLink: document.getElementById('footerLogoLink'),
    mainTime: document.getElementById('mainTime'),
    mainDate: document.getElementById('mainDate'),
    mainLocation: document.getElementById('mainLocation'),
    mainClockContainer: document.getElementById('mainClockContainer'),
    searchContainer: document.getElementById('searchContainer'),
    topSearchContainer: document.getElementById('topSearchContainer'),
    citySearchInputs: document.querySelectorAll('.city-search-input'),
    clocksGrid: document.getElementById('clocksGrid'),
    notesArea: document.getElementById('notesArea'),
    resetBtn: document.getElementById('resetBtn'),
    refreshCardsBtn: document.getElementById('refreshCardsBtn'),
    showAllNotesBtn: document.getElementById('showAllNotesBtn'),
    allNotesModal: document.getElementById('allNotesModal'),
    closeAllNotesBtn: document.getElementById('closeAllNotesBtn'),
    allNotesContent: document.getElementById('allNotesContent'),
    downloadNotesBtn: document.getElementById('downloadNotesBtn'),
    menuBtn: document.getElementById('menuBtn'),
    navOverlay: document.getElementById('navOverlay'),
    navMenu: document.getElementById('navMenu'),
    navLinks: document.querySelectorAll('.nav-link'),
    searchBtn: document.getElementById('searchBtn'),
    settingsBtn: document.getElementById('settingsBtn'),
    settingsModal: document.getElementById('settingsModal'),
    closeSettingsBtn: document.getElementById('closeSettingsBtn'),
    autoThemeToggle: document.getElementById('autoThemeToggle'),
    manualThemeToggle: document.getElementById('manualThemeToggle'),
    manualThemeToggleContainer: document.getElementById('manualThemeToggleContainer'),
    hourFormatToggle: document.getElementById('hourFormatToggle'),
    searchLayoutToggle: document.getElementById('searchLayoutToggle'),
    menuBackgroundToggle: document.getElementById('menuBackgroundToggle'),
    languageSelect: document.getElementById('languageSelect'),
    langLinkBangla: document.getElementById('langLinkBangla'),
    calendarTitleText: document.getElementById('calendarTitleText'),
    calendarGrid: document.getElementById('calendarGrid'),
    recentNotesContainer: document.getElementById('recentNotesContainer'),
    prevMonthBtn: document.getElementById('prevMonthBtn'),
    nextMonthBtn: document.getElementById('nextMonthBtn'),
    datePickerModal: document.getElementById('datePickerModal'),
    closeDatePickerBtn: document.getElementById('closeDatePickerBtn'),
    pickerYearInput: document.getElementById('pickerYearInput'),
    prevYearBtn: document.getElementById('prevYearBtn'),
    nextYearBtn: document.getElementById('nextYearBtn'),
    datePickerMonthsGrid: document.getElementById('datePickerMonthsGrid'),
    fullscreenOverlay: document.getElementById('fullscreenOverlay'),
    fullscreenTime: document.getElementById('fullscreenTime'),
    fullscreenDate: document.getElementById('fullscreenDate'),
    fullscreenVideoPlayer: document.getElementById('fullscreenVideoPlayer'),
    fullscreenHint: document.getElementById('fullscreenHint'),
    popularCitiesContainer: document.getElementById('popular-cities-container'),
    quoteContainer: document.getElementById('quoteContainer'),
    quoteText: document.getElementById('quoteText'),
    quoteAuthor: document.getElementById('quoteAuthor'),
    stopwatchDisplay: document.getElementById('stopwatchDisplay'),
    stopwatchToggleBtn: document.getElementById('stopwatchToggleBtn'),
    stopwatchLapBtn: document.getElementById('stopwatchLapBtn'),
    stopwatchResetBtn: document.getElementById('stopwatchResetBtn'),
    lapsList: document.getElementById('lapsList'),
    timerDisplay: document.getElementById('timerDisplay'),
    timerInputsContainer: document.getElementById('timerInputs'),
    timerHoursInput: document.getElementById('timerHours'),
    timerMinutesInput: document.getElementById('timerMinutes'),
    timerSecondsInput: document.getElementById('timerSeconds'),
    timerToggleBtn: document.getElementById('timerToggleBtn'),
    timerResetBtn: document.getElementById('timerResetBtn'),
    alarmTimeInput: document.getElementById('alarmTimeInput'),
    alarmLabelInput: document.getElementById('alarmLabelInput'),
    addAlarmBtn: document.getElementById('addAlarmBtn'),
    alarmsList: document.getElementById('alarmsList'),
    ambientAudioPlayer: document.getElementById('ambient-audio-player'),
    uiText: {
        notesTitle: document.getElementById('notesTitle'),
        calendarSectionTitle: document.getElementById('calendarSectionTitle'),
        settingsModalTitle: document.getElementById('settingsModalTitle'),
        themeSettingsTitle: document.getElementById('themeSettingsTitle'),
        formatSettingsTitle: document.getElementById('formatSettingsTitle'),
        layoutSettingsTitle: document.getElementById('layoutSettingsTitle'),
        languageSettingsTitle: document.getElementById('languageSettingsTitle'),
        autoThemeLabel: document.getElementById('autoThemeLabel'),
        darkThemeLabel: document.getElementById('darkThemeLabel'),
        hourFormatLabel: document.getElementById('hourFormatLabel'),
        searchLayoutLabel: document.getElementById('searchLayoutLabel'),
        menuBackgroundLabel: document.getElementById('menuBackgroundLabel'),
        allNotesTitle: document.getElementById('allNotesTitle'),
        showAllNotesBtn: document.getElementById('showAllNotesBtn'),
        // Added ID reference
        refreshCardsBtn: document.getElementById('refreshCardsBtn'),
        popularCitiesTitle: document.getElementById('popularCitiesTitle'),
    }
};

let state = {
    mainClock: null, 
    pinnedClocks: [],
    settings: {
        autoTheme: true,
        manualThemeDark: false,
        is24Hour: true,
        language: 'en',
        searchLayout: 'top', // Default to top
        menuBackground: true
    },
    currentCalendarDate: new Date(),
    selectedDate: new Date(), 
    notes: {}, 
    stopwatch: {
        startTime: 0,
        elapsedTime: 0,
        intervalId: null,
        laps: []
    },
    timer: {
        totalSeconds: 0,
        remainingSeconds: 0,
        intervalId: null 
    },
    alarms: [],
    alarmCheckInterval: null,
    currentlyPlayingButton: null
};

let clockUpdateInterval = null; 
const API_BASE_URL = 'https://worldtimeapi.org/api';

const quotes = [
            { text: "Act now; hesitation steals life's best opportunities.", author: "Marcus Aurelius" },
            { text: "Time is honest; it reveals our true priorities.", author: "Marcus Aurelius" },
            { text: "Time rewards purposeful struggle, not effortless comfort.", author: "Marcus Aurelius" },
            { text: "Time teaches, if you are willing to learn daily.", author: "Seneca" },
            { text: "Time heals, but wasted time wounds future possibilities.", author: "Epictetus" },
            { text: "Time demands focus; scattered attention yields little.", author: "Epictetus" },
            { text: "Small, steady time investments beat sudden bursts every time.", author: "Epictetus" },
            { text: "Measure life by moments used, not hours wasted.", author: "Socrates" },
            { text: "Time values honest labour above clever shortcuts.", author: "Socrates" },
            { text: "Use time to question boldly, then to improve.", author: "Socrates" },
            { text: "Time spent learning returns lifelong dividends.", author: "Plato" },
            { text: "Time is a mirror: your habits reflect back.", author: "Plato" },
            { text: "Time is the workshop where knowledge becomes wisdom.", author: "Plato" },
            { text: "Time made discipline into genius through repetition.", author: "Aristotle" },
            { text: "Time is the teacher that rewards steady curiosity.", author: "Aristotle" },
            { text: "Time rewards the disciplined thinker who also acts.", author: "Aristotle" },
            { text: "Small daily disciplines yield huge time dividends.", author: "Confucius" },
            { text: "Time reveals the outcome of consistent moral choices.", author: "Confucius" },
            { text: "Use time to practice kindness as a daily habit.", author: "Confucius" },
            { text: "Time is the quiet ally of persistent purpose.", author: "Lao Tzu" },
            { text: "Time reveals what simplicity and focus can accomplish.", author: "Lao Tzu" },
            { text: "Time multiplies meaning when paired with simplicity.", author: "Lao Tzu" },
            { text: "Time turns intention into either results or regret.", author: "Buddha" },
            { text: "Time turns repeated practice into effortless skill.", author: "Buddha" },
            { text: "Time refines compassion when acted upon consistently.", author: "Buddha" },
            { text: "Live deliberately; let time reward your choices.", author: "Al-Ghazali" },
            { text: "Use time to cultivate inner strength and craft.", author: "Al-Ghazali" },
            { text: "Use time to master the craft you love.", author: "Al-Ghazali" },
            { text: "Time is the truest measure of commitment.", author: "Ibn Sina (Avicenna)" },
            { text: "Time is tiny steps toward monumental change.", author: "Ibn Sina (Avicenna)" },
            { text: "Minutes of discipline outweigh months of empty dreaming.", author: "Ibn Sina (Avicenna)" },
            { text: "Use time to build, not merely to plan.", author: "Rumi" },
            { text: "Spend mornings on creating, evenings on learning more.", author: "Rumi" },
            { text: "Time rewards focus applied to essential tasks.", author: "Rumi" },
            { text: "Plan quickly, act faster, reflect faster still.", author: "Imam Ali" },
            { text: "Time appreciates decisive action over hesitant planning.", author: "Imam Ali" },
            { text: "Time is a friend to decisive, honest action.", author: "Imam Ali" },
            { text: "Time waits for no one; move with urgency.", author: "Allama Iqbal" },
            { text: "Value time; it's the true measure of freedom.", author: "Allama Iqbal" },
            { text: "Value minutes; they become years before you notice.", author: "Ibn Rushd (Averroes)" },
            { text: "Time crafts leaders through patient, humble repetition.", author: "Ibn Rushd (Averroes)" },
            { text: "Time is the raw material of achievement.", author: "Ibn Khaldun" },
            { text: "Time reveals priorities by what you consistently choose.", author: "Ibn Khaldun" },
            { text: "Time punishes wasted promise, rewards fulfilled effort.", author: "Ibn Khaldun" },
            { text: "Guard your time; others will gladly consume it.", author: "Al-Farabi" },
            { text: "Time rewards disciplined builders, not fleeting performers.", author: "Al-Farabi" },
            { text: "Time is the forge of patient excellence.", author: "Al-Farabi" },
            { text: "Time punished the idle, favors the persistent.", author: "Al-Biruni" },
            { text: "Time is a teacher of stubborn persistence.", author: "Al-Biruni" },
            { text: "Use time to learn; knowledge compounds across years.", author: "Al-Biruni" },
            { text: "Time is the adviser that speaks through results.", author: "Ibn Taymiyyah" },
            { text: "Time values truth; speak and act accordingly.", author: "Ibn Taymiyyah" },
            { text: "Time reveals sincerity through repeated, humble action.", author: "Ibn Taymiyyah" },
            { text: "Minutes create momentum; momentum creates breakthroughs.", author: "Imam Bukhari" },
            { text: "Turn minutes into momentum; start with one small task.", author: "Imam Bukhari" },
            { text: "Time demands action; wisdom follows from doing.", author: "Ibn Majah" },
            { text: "Time rewards those who match faith with concrete deeds.", author: "Ibn Majah" },
            { text: "Time rewards humility paired with relentless effort.", author: "Imam Malik" },
            { text: "Time shapes character through patient devotion and work.", author: "Imam Malik" },
            { text: "Preserve time for what matures into meaning.", author: "Imam Shafi'i" },
            { text: "Time is honest; it returns what you consistently sow.", author: "Imam Shafi'i" },
            { text: "Time is strict; use it with wise intention.", author: "Ibn Hazm" },
            { text: "Use time to create knowledge, not only to display it.", author: "Ibn Hazm" },
            { text: "Time refines character through repeated small choices.", author: "Sadi of Shiraz" },
            { text: "Time builds legacy through modest, consistent contributions.", author: "Sadi of Shiraz" },
            { text: "Act now; future success grows from today's tasks.", author: "Hafez" },
            { text: "Time rewards the patient craftsman more than the quick show.", author: "Hafez" },
            { text: "Time exposes truth; live in alignment daily.", author: "Aisha bint Abu Bakr" },
            { text: "Invest time in truth; it repays with clarity.", author: "Aisha bint Abu Bakr" },
            { text: "Time reveals leadership by persistent, steady deeds.", author: "Umar ibn al-Khattab" },
            { text: "Time is a mirror; your priorities show plainly.", author: "Umar ibn al-Khattab" },
            { text: "Spend time shaping values, not only outcomes.", author: "Ali ibn Abi Talib" },
            { text: "Time rewards courage to act despite fear.", author: "Ali ibn Abi Talib" },
            { text: "Use time to improve self, then to uplift others.", author: "Ali ibn Abi Talib" },
            { text: "Time is honest; it rewards steady, small effort.", author: "Albert Einstein" },
            { text: "Time is counted value; spend it on creation.", author: "Albert Einstein" },
            { text: "Time sharpens curiosity into applied discovery.", author: "Albert Einstein" },
            { text: "Don't delay; the future needs what you build today.", author: "Leonardo da Vinci" },
            { text: "Time respects those who show up, day after day.", author: "Leonardo da Vinci" },
            { text: "Time demands creating more than merely consuming.", author: "Leonardo da Vinci" },
            { text: "Time shapes knowledge into usable wisdom through repetition.", author: "Euclid" },
            { text: "Time rewards those who document then execute diligently.", author: "Euclid" },
            { text: "Time demands experiments; learn fast, iterate faster.", author: "Galileo Galilei" },
            { text: "Time rewards those who test ideas early and often.", author: "Galileo Galilei" },
            { text: "Use time to test hypotheses, then scale success.", author: "Galileo Galilei" },
            { text: "Treasure time; it's rarer than gold.", author: "Nicolaus Copernicus" },
            { text: "Time respects those who create patiently, steadily.", author: "Nicolaus Copernicus" },
            { text: "Time rewards curiosity executed with steady work.", author: "Stephen Hawking" },
            { text: "Time is the laboratory for audacious experiments.", author: "Stephen Hawking" },
            { text: "Time blesses persistent curiosity with real discovery.", author: "Stephen Hawking" },
            { text: "Time measures the worth of every small effort.", author: "Pliny the Elder" },
            { text: "Time silently crowns the persistent and forgets the rest.", author: "Pliny the Elder" },
            { text: "Time honors repeated craftsmanship over fleeting brilliance.", author: "Pliny the Elder" },
            { text: "Time multiplies mastery for patient practitioners.", author: "Ibn al-Nafis" },
            { text: "Use minutes now to avoid future desperation.", author: "Ibn al-Nafis" },
            { text: "Time is methodical; show up, day after day.", author: "Al-Kindi" },
            { text: "Use time to experiment, refine, then scale.", author: "Al-Kindi" },
            { text: "Use each moment to perfect your craft.", author: "Ibn al-Haytham" },
            { text: "Time is the patient architect of understanding.", author: "Ibn al-Haytham" },
            { text: "Invest time to understand deeply, then to innovate.", author: "Ibn al-Haytham" },
            { text: "Waste a minute, lose the rhythm for days.", author: "William Shakespeare" },
            { text: "Today shapes tomorrow; use time with intention.", author: "William Shakespeare" },
            { text: "Time organizes life; design your hours intentionally.", author: "William Shakespeare" },
            { text: "Time respects consistent learning more than flashy talent.", author: "William Shakespeare" },
            { text: "Short daily work beats sporadic grand gestures.", author: "Mark Twain" },
            { text: "Time is the raw material of rare craftsmanship.", author: "Mark Twain" },
            { text: "Value each minute as an investment in future mastery.", author: "Mark Twain" },
            { text: "Time rewards those who pursue mastery patiently.", author: "Mark Twain" },
            { text: "Time shows character; daily actions reveal truth.", author: "Victor Hugo" },
            { text: "Small daily efforts compounded shape remarkable time outcomes.", author: "Victor Hugo" },
            { text: "Time cleanses distractions; focus refines purpose.", author: "Victor Hugo" },
            { text: "Time's treasure: small, steady improvements compounded.", author: "Pablo Picasso" },
            { text: "Time makes ordinary practice produce extraordinary skill.", author: "Pablo Picasso" },
            { text: "Time is the ally of patient creative labor.", author: "Pablo Picasso" },
            { text: "Don't postpone excellence; practice it every single day.", author: "Stephen King" },
            { text: "Act now and let time handle results.", author: "Stephen King" },
            { text: "Time respects the humble worker who never quits.", author: "Stephen King" },
            { text: "Time is the only equalizer of possibility.", author: "J.K. Rowling" },
            { text: "Time is silent; its results speak volumes later.", author: "J.K. Rowling" },
            { text: "Spend minutes making meaningful art, in any discipline.", author: "J.K. Rowling" },
            { text: "Time rewards those who take consistent tiny steps.", author: "Charlie Chaplin" },
            { text: "Time will reward the humble daily worker.", author: "Charlie Chaplin" },
            { text: "Make time your practice; mastery will follow.", author: "Charlie Chaplin" },
            { text: "Time is a lens focusing consistent daily practice.", author: "Rabindranath Tagore" },
            { text: "Time grows wisdom for those who steadily seek it.", author: "Rabindranath Tagore" },
            { text: "Time reveals wisdom for those who remain teachable.", author: "Rabindranath Tagore" },
            { text: "Time is kind to humble, consistent effort.", author: "Khalil Gibran" },
            { text: "Time values subtle improvements more than grand promises.", author: "Khalil Gibran" },
            { text: "Turn minutes into meaning; act with purpose now.", author: "Dante Alighieri" },
            { text: "Be faithful with minutes; time will reward you.", author: "Dante Alighieri" },
            { text: "Don't waste time polishing illusions; build real value.", author: "George Eliot" },
            { text: "Spend time where value compounds, not where it dilutes.", author: "George Eliot" },
            { text: "Time is brief; make your actions unmistakably meaningful.", author: "Emily Dickinson" },
            { text: "Time is honest; it measures what truly matters.", author: "Emily Dickinson" },
            { text: "Time forgives mistakes more easily than wasted years.", author: "Edgar Allan Poe" },
            { text: "Time rewards courage shown consistently, not occasionally.", author: "Edgar Allan Poe" },
            { text: "Let time reward the work you quietly do.", author: "John Milton" },
            { text: "Time is the patient architect of lasting achievement.", author: "John Milton" },
            { text: "Time is relentless; choose commitments you can keep.", author: "Thomas Edison" },
            { text: "Time is limited; pick commitments you can keep.", author: "Thomas Edison" },
            { text: "Time turns curiosity into competence through practice.", author: "Ralph Waldo Emerson" },
            { text: "Time rewards the curious who turn questions into answers.", author: "Ralph Waldo Emerson" },
            { text: "Time rewards those who convert failure into lessons.", author: "Ralph Waldo Emerson" },
            { text: "Time's patience builds mountains from daily footsteps.", author: "Henry David Thoreau" },
            { text: "Spend time on ideas that outlast your impatience.", author: "Henry David Thoreau" },
            { text: "Use time to mature ideas into tested truths.", author: "Henry David Thoreau" },
            { text: "Time is a stern coach; listen and improve.", author: "Samuel Johnson" },
            { text: "Time grows mastery through humble repeated practice.", author: "Samuel Johnson" },
            { text: "Time is your scarce capital; spend it on what matters most.", author: "Steve Jobs" },
            { text: "Time is the measuring stick of silent progress.", author: "Steve Jobs" },
            { text: "Give time to what will outlast your impatience.", author: "Steve Jobs" },
            { text: "Time rewards early starters who persist through setbacks.", author: "Steve Jobs" },
            { text: "What’s for tomorrow, do today; what’s for today, do now.", author: "Colonel Nurun Nabi" },
            { text: "Time punishes delay; start even imperfectly today.", author: "Colonel Nurun Nabi" },
            { text: "Do not delay: start imperfectly, finish remarkably.", author: "Colonel Nurun Nabi" },
            { text: "Don't waste time; perfection often hides in procrastination.", author: "Ratan Tata" },
            { text: "Act swiftly; delay amplifies uncertainty and loss.", author: "Ratan Tata" },
            { text: "Act now; success favors prompt, bold action.", author: "Ratan Tata" },
            { text: "Minute choices become destiny; choose them deliberately today.", author: "Ratan Tata" },
            { text: "Minutes define destiny more than intentions ever will.", author: "Michael Jackson" },
            { text: "Time is finite; invest it in meaningful creation.", author: "Michael Jackson" },
            { text: "Use your time to create beauty and usefulness.", author: "Michael Jackson" },
            { text: "Every moment invested compounds into future advantage.", author: "Ryan Holiday" },
            { text: "Start now; perfection is the enemy of progress.", author: "Ryan Holiday" },
            { text: "Time is the arena where courage becomes habit.", author: "Ryan Holiday" },
            { text: "Time rewards those who keep improving, always.", author: "Steve Wozniak" },
            { text: "Time is earned through small disciplined daily acts.", author: "Steve Wozniak" },
            { text: "Time accumulates small habits into extraordinary skill.", author: "Steve Wozniak" },
            { text: "Time multiplies when you focus on essential work.", author: "Bill Gates" },
            { text: "Time is limited; choose depth over endless breadth.", author: "Bill Gates" },
            { text: "Time is the test of all meaningful work.", author: "Bill Gates" },
            { text: "Time is brief; allocate it to enduring pursuits.", author: "Bill Gates" },
            { text: "Respect time; it sculpts ordinary efforts into excellence.", author: "Elon Musk" },
            { text: "Time magnifies the brave who persist through adversity.", author: "Elon Musk" },
            { text: "Time turns repeated failures into eventual success.", author: "Elon Musk" },
            { text: "Use time to build strengths, not excuses.", author: "Elon Musk" },
            { text: "Time is a resource; manage it like capital.", author: "Tim Cook" },
            { text: "Guard your time like your most precious asset.", author: "Tim Cook" },
            { text: "Time is precious; steward it like a trust.", author: "Tim Cook" },
            { text: "Protect your time from needless urgency and noise.", author: "Sheryl Sandberg" },
            { text: "Time is earned through discipline more than desire.", author: "Sheryl Sandberg" },
            { text: "Protect time from noise; create with deep focus.", author: "Sheryl Sandberg" },
            { text: "Focus time on leverage, not on busywork.", author: "Larry Page" },
            { text: "Time multiplies when you harness collective focus.", author: "Larry Page" },
            { text: "Time grows impact when you remove needless tasks.", author: "Larry Page" },
            { text: "Time grows impact when you prioritize ruthlessly.", author: "Sergey Brin" },
            { text: "Time demands meaningful questions more than instant answers.", author: "Sergey Brin" },
            { text: "Time multiplies results when teams move with clarity.", author: "Sergey Brin" },
            { text: "Time values products that solve real human problems.", author: "Sundar Pichai" },
            { text: "Protect time from the trivial; nurture depth.", author: "Sundar Pichai" },
            { text: "Use time to build durable, useful products.", author: "Sundar Pichai" },
            { text: "Work with urgency; time doesn't promise tomorrow.", author: "Richard Branson" },
            { text: "Time is generous to those who show up daily.", author: "Richard Branson" },
            { text: "Time rewards those who combine hustle with reflection.", author: "Richard Branson" },
            { text: "Time appreciates disciplined routines more than occasional genius.", author: "Jack Ma" },
            { text: "Time rewards those who turn scarcity into creativity.", author: "Jack Ma" },
            { text: "Time is finite; create value that outlives you.", author: "Jack Ma" },
            { text: "Use time to build systems, not only tasks.", author: "Howard Schultz" },
            { text: "Spend time on systems that amplify your efforts.", author: "Howard Schultz" },
            { text: "Use time to systematize success, not just chase it.", author: "Howard Schultz" },
            { text: "Time is precious; guard it from trivial demands.", author: "Winston Churchill" },
            { text: "Don't borrow tomorrow's time for today's comfort.", author: "Winston Churchill" },
            { text: "Time will reward the prepared who act decisively.", author: "Winston Churchill" },
            { text: "Time is brief; act like it is precious.", author: "Winston Churchill" },
            { text: "Every minute counts toward freedom from regret.", author: "Abraham Lincoln" },
            { text: "Time is the stage where effort becomes legend.", author: "Abraham Lincoln" },
            { text: "Spend time building character; results will follow inevitably.", author: "Abraham Lincoln" },
            { text: "Time shapes history through repeated humble actions.", author: "Abraham Lincoln" },
            { text: "Time forgives effort but not prolonged neglect.", author: "John F. Kennedy" },
            { text: "Time is the currency of responsibility; spend wisely.", author: "John F. Kennedy" },
            { text: "Spend time perfecting essentials rather than chasing many things.", author: "John F. Kennedy" },
            { text: "Time is the canvas where habits paint outcomes.", author: "Margaret Thatcher" },
            { text: "Use time to answer questions, not to avoid them.", author: "Margaret Thatcher" },
            { text: "Time rewards those who live intentionally, not reactively.", author: "Margaret Thatcher" },
            { text: "Time rewards clarity, not endless rumination.", author: "Mahatma Gandhi" },
            { text: "Minutes used wisely make regrets steadily vanish.", author: "Mahatma Gandhi" },
            { text: "Time gives power to patient, persistent creativity.", author: "Mahatma Gandhi" },
            { text: "Spend time on what your future self will thank.", author: "Mahatma Gandhi" },
            { text: "Use time to serve, not merely to impress.", author: "Nelson Mandela" },
            { text: "Time builds character through repeated small decisions.", author: "Nelson Mandela" },
            { text: "Use time to serve a greater, lasting mission.", author: "Nelson Mandela" },
            { text: "Time turns small kindnesses into lasting reputations.", author: "Nelson Mandela" },
            { text: "Invest time in people who grow alongside you.", author: "Oprah Winfrey" },
            { text: "Time earns trust through consistent, honest work.", author: "Oprah Winfrey" },
            { text: "Time rewards those who refine themselves continually.", author: "Oprah Winfrey" },
            { text: "Guard time fiercely; squander none on empty praise.", author: "Oprah Winfrey" },
            { text: "Value time more than fleeting social applause.", author: "Dalai Lama" },
            { text: "Time is finite; spend it on what elevates others.", author: "Dalai Lama" },
            { text: "Use time to mend, then to build anew.", author: "Dalai Lama" },
            { text: "Make minutes count; they build your legacy.", author: "Martin Luther King Jr." },
            { text: "Minutes invested in learning beat months wasted in doubt.", author: "Martin Luther King Jr." },
            { text: "Time magnifies kindness, making it echo through generations.", author: "Martin Luther King Jr." },
            { text: "Use today's time to create tomorrow's opportunities.", author: "Malala Yousafzai" },
            { text: "Time rewards courage; hesitance steals tomorrow's chances.", author: "Malala Yousafzai" },
            { text: "Time will reward the brave who persistently improve.", author: "Malala Yousafzai" },
            { text: "Time spent well grants freedom later.", author: "Frederick Douglass" },
            { text: "Time converts tiny improvements into undeniable mastery.", author: "Frederick Douglass" },
            { text: "Time reveals the quiet achievers through steady output.", author: "Frederick Douglass" },
            { text: "Time is a teacher; heed its daily lessons.", author: "Simone de Beauvoir" },
            { text: "Time reveals what courage looks like in practice.", author: "Simone de Beauvoir" },
            { text: "Let time teach patience through repeated attempts.", author: "Simone de Beauvoir" },
            { text: "Value time above convenience for lasting success.", author: "Eleanor Roosevelt" },
            { text: "Invest time where your heart and talent meet.", author: "Eleanor Roosevelt" },
            { text: "Time crafts leaders by steady, moral action.", author: "Eleanor Roosevelt" },
            { text: "Time reveals courage; small brave acts add up.", author: "Brene Brown" },
            { text: "Time reveals what you truly choose to protect.", author: "Brene Brown" },
            { text: "Use time to heal, then to build anew.", author: "Brene Brown" },
            { text: "Time rewards leadership that serves, not merely speaks.", author: "Angela Merkel" },
            { text: "Time teaches leadership by consistent, humble service.", author: "Angela Merkel" },
            { text: "Time rewards those who persist with humble excellence.", author: "Angela Merkel" },
            { text: "Time is a mirror reflecting what you prioritize.", author: "Stephen Covey" },
            { text: "Time respects those who plan but act faster.", author: "Stephen Covey" },
            { text: "Treat time as a partner, not an adversary.", author: "Stephen Covey" },
            { text: "Every minute is proof of your chosen priorities.", author: "Peter Drucker" },
            { text: "Spend time on what moves outcomes forward.", author: "Peter Drucker" },
            { text: "Time compounds when guided by clear priorities.", author: "Peter Drucker" },
            { text: "Time is the currency of thoughtful, steady improvement.", author: "Ibn al-Nafis" },
            { text: "Time rewards those who convert ideas into action.", author: "John Locke" },
            { text: "Time is invested where commitment meets careful planning.", author: "John Locke" },
            { text: "Time is the stage where perseverance proves its worth.", author: "John Locke" },
            { text: "Every minute matters; use it for meaningful pursuit.", author: "Niccolò Machiavelli" },
            { text: "Time is brief; align it with your deepest aim.", author: "Niccolò Machiavelli" },
            { text: "Time rewards those who align actions with clear strategy.", author: "Niccolò Machiavelli" },
            { text: "Time is strategy's most unforgiving opponent; act.", author: "Sun Tzu" },
            { text: "Time is strategic; use it to shape outcomes.", author: "Sun Tzu" },
            { text: "Use time to prepare; victory favors the ready.", author: "Sun Tzu" },
            { text: "Time magnifies choices; choose long-term value.", author: "Genghis Khan" },
            { text: "Time is relentless; build habits that survive it.", author: "Genghis Khan" },
            { text: "Time is impartial; it shows who truly persisted.", author: "Genghis Khan" },
            { text: "Time builds habits that shape entire lifetimes.", author: "Benjamin Franklin" },
            { text: "Use time to craft habits, then guard them.", author: "Benjamin Franklin" },
            { text: "Time honors the work that quietly improves lives.", author: "Benjamin Franklin" },
            { text: "Time prefers perseverance to occasional brilliance.", author: "Benjamin Franklin" },
            { text: "Procrastination multiplies tasks; start now to shrink them.", author: "Mother Teresa" },
            { text: "Time is the margin between chaos and achievement.", author: "Mother Teresa" },
            { text: "Time is a stern teacher: show up regardless.", author: "Mother Teresa" },
            { text: "Spend time learning more than showing off.", author: "Yusuf Islam (Cat Stevens)" },
            { text: "Shape time with learning, service, and steady effort.", author: "Yusuf Islam (Cat Stevens)" },
            { text: "Spend time nurturing virtue; its returns are infinite.", author: "Yusuf Islam (Cat Stevens)" },
            { text: "Minutes saved today are milestones tomorrow.", author: "Anas ibn Malik" },
            { text: "Time is built from minutes of focused intention.", author: "Anas ibn Malik" },
            { text: "Time rewards those who convert prayer into purposeful action.", author: "Anas ibn Malik" },
            { text: "Time is the measuring stick of silent progress.", author: "Steve Jobs" },
            { text: "Time rewards those who simplify and execute consistently.", author: "Marcus Aurelius" },
            { text: "Time clarifies purpose when you pursue it daily.", author: "Marcus Aurelius" },
            { text: "Time demands presence; be fully here and now.", author: "Marcus Aurelius" },
            { text: "Time is truth's ally; results will reveal sincerity.", author: "Marcus Aurelius" },
            { text: "Cultivate small wins; time will compound them cleverly.", author: "Seneca" },
            { text: "Keep time sacred; it shapes the soul's daily work.", author: "Seneca" },
            { text: "Time is an ally when discipline meets patience.", author: "Seneca" },
            { text: "Time composes greatness from many small consistent acts.", author: "Epictetus" },
            { text: "Minutes of effort beat hours of idle dreaming.", author: "Al-Ghazali" },
            { text: "Time spent wisely creates freedom for future choices.", author: "Allama Iqbal" },
            { text: "Value time by aligning tasks with highest priorities.", author: "Allama Iqbal" },
            { text: "Time is a compass directing purposeful lives.", author: "Ibn Rushd (Averroes)" },
            { text: "Time is the home of steady, meaningful effort.", author: "Ibn Rushd (Averroes)" },
            { text: "Time shapes civilizations through daily collective habits.", author: "Al-Biruni" },
            { text: "Time is the greatest teacher of real priorities.", author: "Imam Ali" },
            { text: "Use time to move toward the life you want.", author: "Lao Tzu" },
            { text: "Time is the potter shaping disciplined living.", author: "Buddha" },
            { text: "Time is the apprenticeship of becoming wise.", author: "Plato" },
            { text: "Time chisels talent into enduring mastery.", author: "Euclid" },
            { text: "Time respects the curious who act on questions.", author: "Nicolaus Copernicus" },
            { text: "Time is the crucible where insight becomes skill.", author: "Al-Kindi" },
            { text: "Use time to question, then to act.", author: "Socrates" },
            { text: "Time forgives hustle more than endless planning.", author: "Marcus Aurelius" },
            { text: "Time is earned by work, not by intention.", author: "Ryan Holiday" },
            { text: "Time favors those who clear distractions, then create.", author: "Ratan Tata" },
            { text: "Use minutes to create rather than to consume endlessly.", author: "Michael Jackson" },
            { text: "Minutes of practice outvalue a thousand empty plans.", author: "Imam Bukhari" },
            { text: "Time favors those who convert prayer into action.", author: "Ibn Majah" },
            { text: "Time multiplies truth when practiced consistently every day.", author: "Ibn Hazm" },
            { text: "Use time to craft beauty where practical good is needed.", author: "Hafez" },
            { text: "Spend time in study, then in humble service.", author: "Aisha bint Abu Bakr" },
            { text: "Time is earned by those who act bravely daily.", author: "Umar ibn al-Khattab" },
            { text: "Spend time solving problems, not just discussing them.", author: "Albert Einstein" },
            { text: "Time is a companion for those who keep showing up.", author: "Leonardo da Vinci" },
            { text: "Turn minutes into mastery through consistent iteration.", author: "Pliny the Elder" },
            { text: "Use time now to avoid future desperation.", author: "Ibn al-Nafis" },
            { text: "Time reveals what simplicity and focus can accomplish.", author: "Lao Tzu" },
            { text: "Use time to question boldly, then to improve.", author: "Socrates" },
            { text: "Time rewards the disciplined thinker who also acts.", author: "Aristotle" },
            { text: "Time shapes character through patient devotion and work.", author: "Imam Malik" },
            { text: "Use time to learn, then to wisely apply knowledge.", author: "Imam Shafi'i" },
            { text: "Time is a test: persist and you'll be refined.", author: "Sadi of Shiraz" },
            { text: "Time rewards the disciplined thinker who also acts.", author: "Aristotle" },
            { text: "Time organizes life; design your hours intentionally.", author: "William Shakespeare" },
            { text: "Time demands creating more than merely consuming.", author: "Leonardo da Vinci" },
            { text: "Minutes invested in learning beat months wasted in doubt.", author: "Martin Luther King Jr." },
            { text: "Time cleanses distractions; focus refines purpose.", author: "Victor Hugo" },
            { text: "Time is silent; its results speak volumes later.", author: "J.K. Rowling" },
            { text: "Minutes of practice outvalue a thousand empty plans.", author: "Imam Bukhari" },
            { text: "Time favors those who convert prayer into action.", author: "Ibn Majah" },
            { text: "Time multiplies truth when practiced consistently every day.", author: "Ibn Hazm" },
            { text: "Use time to craft beauty where practical good is needed.", author: "Hafez" },
            { text: "Spend time in study, then in humble service.", author: "Aisha bint Abu Bakr" },
            { text: "Time is earned by those who act bravely daily.", author: "Umar ibn al-Khattab" },
            { text: "Use time to improve self, then to uplift others.", author: "Ali ibn Abi Talib" },
            { text: "Time reveals wisdom for those who remain teachable.", author: "Rabindranath Tagore" },
            { text: "Time rewards those who align actions with clear strategy.", author: "Niccolò Machiavelli" },
            { text: "Use time to prepare; victory favors the ready.", author: "Sun Tzu" },
            { text: "Time is impartial; it shows who truly persisted.", author: "Genghis Khan" },
            { text: "Time honors repeated craftsmanship over fleeting brilliance.", author: "Pliny the Elder" },
            { text: "Use time to test hypotheses, then scale success.", author: "Galileo Galilei" },
            { text: "Time respects the curious who act on questions.", author: "Nicolaus Copernicus" },
            { text: "Time blesses persistent curiosity with real discovery.", author: "Stephen Hawking" },
            { text: "Guard your time like your most precious asset.", author: "Tim Cook" },
            { text: "Time is earned through discipline more than desire.", author: "Sheryl Sandberg" },
            { text: "Time multiplies when you harness collective focus.", author: "Larry Page" },
            { text: "Time demands meaningful questions more than instant answers.", author: "Sergey Brin" },
            { text: "Protect time from the trivial; nurture depth.", author: "Sundar Pichai" },
            { text: "Time is generous to those who show up daily.", author: "Richard Branson" },
            { text: "Time rewards those who turn scarcity into creativity.", author: "Jack Ma" },
            { text: "Spend time on systems that amplify your efforts.", author: "Howard Schultz" },
            { text: "Time converts tiny improvements into undeniable mastery.", author: "Frederick Douglass" },
            { text: "Time reveals what courage looks like in practice.", author: "Simone de Beauvoir" },
            { text: "Invest time where your heart and talent meet.", author: "Eleanor Roosevelt" },
            { text: "Time reveals what you truly choose to protect.", author: "Brene Brown" },
            { text: "Time teaches leadership by consistent, humble service.", author: "Angela Merkel" },
            { text: "Time respects those who plan but act faster.", author: "Stephen Covey" },
            { text: "Spend time on what moves outcomes forward.", author: "Peter Drucker" },
            { text: "Time is the currency of thoughtful, steady improvement.", author: "Ibn al-Nafis" },
            { text: "Use time to experiment, refine, then scale.", author: "Al-Kindi" },
            { text: "Time is the patient architect of understanding.", author: "Ibn al-Haytham" },
            { text: "Time rewards the curious who turn questions into answers.", author: "Ralph Waldo Emerson" },
            { text: "Spend time on ideas that outlast your impatience.", author: "Henry David Thoreau" },
            { text: "Time values subtle improvements more than grand promises.", author: "Khalil Gibran" },
            { text: "Be faithful with minutes; time will reward you.", author: "Dante Alighieri" },
            { text: "Time is limited; pick commitments you can keep.", author: "Thomas Edison" },
            { text: "Time grows mastery through humble repeated practice.", author: "Samuel Johnson" },
            { text: "Spend time where value compounds, not where it dilutes.", author: "George Eliot" },
            { text: "Time is honest; it measures what truly matters.", author: "Emily Dickinson" },
            { text: "Time rewards courage shown consistently, not occasionally.", author: "Edgar Allan Poe" },
            { text: "Time is the patient architect of lasting achievement.", author: "John Milton" },
            { text: "Time rewards early starters who persist through setbacks.", author: "Steve Jobs" },
            { text: "Start where you are. Use what you have. Do what you can.", author: "Arthur Ashe" },
            { text: "Time favors those who clear distractions, then create.", author: "Ratan Tata" },
            { text: "Use minutes to create rather than to consume endlessly.", author: "Michael Jackson" },
            { text: "Time is truth's ally; results will reveal sincerity.", author: "Marcus Aurelius" },
            { text: "Keep time sacred; it shapes the soul's daily work.", author: "Seneca" },
            { text: "Time composes greatness from many small consistent acts.", author: "Epictetus" },
            { text: "Time is earned by work, not by intention.", author: "Ryan Holiday" },
            { text: "Time forgives hustle more than endless planning.", author: "Marcus Aurelius" },
            { text: "Use time to master the craft you love.", author: "Al-Ghazali" },
            { text: "Minutes of discipline outweigh months of empty dreaming.", author: "Ibn Sina (Avicenna)" },
            { text: "Time rewards focus applied to essential tasks.", author: "Rumi" },
            { text: "Time is the greatest teacher of real priorities.", author: "Imam Ali" },
            { text: "Value time; it's the true measure of freedom.", author: "Allama Iqbal" },
            { text: "Time is the home of steady, meaningful effort.", author: "Ibn Rushd (Averroes)" },
            { text: "Time punishes wasted promise, rewards fulfilled effort.", author: "Ibn Khaldun" },
            { text: "Time is the forge of patient excellence.", author: "Al-Farabi" },
            { text: "Use time to learn; knowledge compounds across years.", author: "Al-Biruni" },
            { text: "Time prefers perseverance to occasional brilliance.", author: "Benjamin Franklin" },
            { text: "Time sharpens curiosity into applied discovery.", author: "Albert Einstein" },
            { text: "Spend time on what your future self will thank.", author: "Mahatma Gandhi" },
            { text: "Time turns small kindnesses into lasting reputations.", author: "Nelson Mandela" },
            { text: "Time is the test of all meaningful work.", author: "Bill Gates" },
            { text: "Use time to build strengths, not excuses.", author: "Elon Musk" },
            { text: "Time shapes history through repeated humble actions.", author: "Abraham Lincoln" },
            { text: "Time compounds when guided by clear priorities.", author: "Peter Drucker" }
        ];


const cityData = [
    { name: "New York", country: "USA", timezone: "America/New_York", flag: "🇺🇸" },
    { name: "London", country: "United Kingdom", timezone: "Europe/London", flag: "🇬🇧" },
    { name: "Tokyo", country: "Japan", timezone: "Asia/Tokyo", flag: "🇯🇵" },
    { name: "Paris", country: "France", timezone: "Europe/Paris", flag: "🇫🇷" },
    { name: "Sydney", country: "Australia", timezone: "Australia/Sydney", flag: "🇦🇺" },
    { name: "Dhaka", country: "Bangladesh", timezone: "Asia/Dhaka", flag: "🇧🇩" },
    { name: "Berlin", country: "Germany", timezone: "Europe/Berlin", flag: "🇩🇪" },
    { name: "Los Angeles", country: "USA", timezone: "America/Los_Angeles", flag: "🇺🇸" },
    { name: "Chicago", country: "USA", timezone: "America/Chicago", flag: "🇺🇸" },
    { name: "Toronto", country: "Canada", timezone: "America/Toronto", flag: "🇨🇦" },
    { name: "Sao Paulo", country: "Brazil", timezone: "America/Sao_Paulo", flag: "🇧🇷" },
    { name: "Mexico City", country: "Mexico", timezone: "America/Mexico_City", flag: "🇲🇽" },
    { name: "Buenos Aires", country: "Argentina", timezone: "America/Argentina/Buenos_Aires", flag: "🇦🇷" },
    { name: "Lagos", country: "Nigeria", timezone: "Africa/Lagos", flag: "🇳🇬" },
    { name: "Cairo", country: "Egypt", timezone: "Africa/Cairo", flag: "🇪🇬" },
    { name: "Johannesburg", country: "South Africa", timezone: "Africa/Johannesburg", flag: "🇿🇦" },
    { name: "Nairobi", country: "Kenya", timezone: "Africa/Nairobi", flag: "🇰🇪" },
    { name: "Moscow", country: "Russia", timezone: "Europe/Moscow", flag: "🇷🇺" },
    { name: "Madrid", country: "Spain", timezone: "Europe/Madrid", flag: "🇪🇸" },
    { name: "Rome", country: "Italy", timezone: "Europe/Rome", flag: "🇮🇹" },
    { name: "Amsterdam", country: "Netherlands", timezone: "Europe/Amsterdam", flag: "🇳🇱" },
    { name: "Stockholm", country: "Sweden", timezone: "Europe/Stockholm", flag: "🇸🇪" },
    { name: "Istanbul", country: "Turkey", timezone: "Europe/Istanbul", flag: "🇹🇷" },
    { name: "Dubai", country: "UAE", timezone: "Asia/Dubai", flag: "🇦🇪" },
    { name: "Abu Dhabi", country: "UAE", timezone: "Asia/Dubai", flag: "🇦🇪" },
    { name: "Mumbai", country: "India", timezone: "Asia/Kolkata", flag: "🇮🇳" },
    { name: "Delhi", country: "India", timezone: "Asia/Kolkata", flag: "🇮🇳" },
    { name: "Shanghai", country: "China", timezone: "Asia/Shanghai", flag: "🇨🇳" },
    { name: "Beijing", country: "China", timezone: "Asia/Shanghai", flag: "🇨🇳" },
    { name: "Singapore", country: "Singapore", timezone: "Asia/Singapore", flag: "🇸🇬" },
    { name: "Seoul", country: "South Korea", timezone: "Asia/Seoul", flag: "🇰🇷" },
    { name: "Bangkok", country: "Thailand", timezone: "Asia/Bangkok", flag: "🇹🇭" },
    { name: "Jakarta", country: "Indonesia", timezone: "Asia/Jakarta", flag: "🇮🇩" },
    { name: "Kuala Lumpur", country: "Malaysia", timezone: "Asia/Kuala_Lumpur", flag: "🇲🇾" },
    { name: "Ho Chi Minh City", country: "Vietnam", timezone: "Asia/Ho_Chi_Minh", flag: "🇻🇳" },
    { name: "Manila", country: "Philippines", timezone: "Asia/Manila", flag: "🇵🇭" },
    { name: "Auckland", country: "New Zealand", timezone: "Pacific/Auckland", flag: "🇳🇿" },
    { name: "Honolulu", country: "USA", timezone: "Pacific/Honolulu", flag: "🇺🇸" },
    { name: "Ankara", country: "Turkey", timezone: "Europe/Istanbul", flag: "🇹🇷" },
    { name: "Riyadh", country: "Saudi Arabia", timezone: "Asia/Riyadh", flag: "🇸🇦" },
    { name: "Tehran", country: "Iran", timezone: "Asia/Tehran", flag: "🇮🇷" },
    { name: "Baghdad", country: "Iraq", timezone: "Asia/Baghdad", flag: "🇮🇶" },
    { name: "Lima", country: "Peru", timezone: "America/Lima", flag: "🇵🇪" },
    { name: "Bogota", country: "Colombia", timezone: "America/Bogota", flag: "🇨🇴" },
    { name: "Santiago", country: "Chile", timezone: "America/Santiago", flag: "🇨🇱" },
    { name: "Caracas", country: "Venezuela", timezone: "America/Caracas", flag: "🇻🇪" },
    { name: "Helsinki", country: "Finland", timezone: "Europe/Helsinki", flag: "🇫🇮" },
    { name: "Oslo", country: "Norway", timezone: "Europe/Oslo", flag: "🇳🇴" },
    { name: "Copenhagen", country: "Denmark", timezone: "Europe/Copenhagen", flag: "🇩🇰" },
    { name: "Dublin", country: "Ireland", timezone: "Europe/Dublin", flag: "🇮🇪" },
    { name: "Lisbon", country: "Portugal", timezone: "Europe/Lisbon", flag: "🇵🇹" },
    { name: "Prague", country: "Czech Republic", timezone: "Europe/Prague", flag: "🇨🇿" },
    { name: "Warsaw", country: "Poland", timezone: "Europe/Warsaw", flag: "🇵🇱" },
    { name: "Vienna", country: "Austria", timezone: "Europe/Vienna", flag: "🇦🇹" },
    { name: "Budapest", country: "Hungary", timezone: "Europe/Budapest", flag: "🇭🇺" },
    { name: "Athens", country: "Greece", timezone: "Europe/Athens", flag: "🇬🇷" },
    { name: "Addis Ababa", country: "Ethiopia", timezone: "Africa/Addis_Ababa", flag: "🇪🇹" },
    { name: "Karachi", country: "Pakistan", timezone: "Asia/Karachi", flag: "🇵🇰" },
    { name: "Taipei", country: "Taiwan", timezone: "Asia/Taipei", flag: "🇹🇼" },
    { name: "Kabul", country: "Afghanistan", timezone: "Asia/Kabul", flag: "🇦🇫" },
    { name: "Tirana", country: "Albania", timezone: "Europe/Tirane", flag: "🇦🇱" },
    { name: "Algiers", country: "Algeria", timezone: "Africa/Algiers", flag: "🇩🇿" },
    { name: "Andorra la Vella", country: "Andorra", timezone: "Europe/Andorra", flag: "🇦🇩" },
    { name: "Luanda", country: "Angola", timezone: "Africa/Luanda", flag: "🇦🇴" },
    { name: "Saint John's", country: "Antigua and Barbuda", timezone: "America/Antigua", flag: "🇦🇬" },
    { name: "Yerevan", country: "Armenia", timezone: "Asia/Yerevan", flag: "🇦🇲" },
    { name: "Vienna", country: "Austria", timezone: "Europe/Vienna", flag: "🇦🇹" },
    { name: "Baku", country: "Azerbaijan", timezone: "Asia/Baku", flag: "🇦🇿" },
    { name: "Nassau", country: "Bahamas", timezone: "America/Nassau", flag: "🇧🇸" },
    { name: "Manama", country: "Bahrain", timezone: "Asia/Bahrain", flag: "🇧🇭" },
    { name: "Minsk", country: "Belarus", timezone: "Europe/Minsk", flag: "🇧🇾" },
    { name: "Brussels", country: "Belgium", timezone: "Europe/Brussels", flag: "🇧🇪" },
    { name: "Belmopan", country: "Belize", timezone: "America/Belize", flag: "🇧🇿" },
    { name: "Porto-Novo", country: "Benin", timezone: "Africa/Porto-Novo", flag: "🇧🇯" },
    { name: "Thimphu", country: "Bhutan", timezone: "Asia/Thimphu", flag: "🇧🇹" },
    { name: "Sarajevo", country: "Bosnia and Herzegovina", timezone: "Europe/Sarajevo", flag: "🇧🇦" },
    { name: "Gaborone", country: "Botswana", timezone: "Africa/Gaborone", flag: "🇧🇼" },
    { name: "Bandar Seri Begawan", country: "Brunei", timezone: "Asia/Brunei", flag: "🇧🇳" },
    { name: "Sofia", country: "Bulgaria", timezone: "Europe/Sofia", flag: "🇧🇬" },
    { name: "Ouagadougou", country: "Burkina Faso", timezone: "Africa/Ouagadougou", flag: "🇧🇫" },
    { name: "Bujumbura", country: "Burundi", timezone: "Africa/Bujumbura", flag: "🇧🇮" },
    { name: "Phnom Penh", country: "Cambodia", timezone: "Asia/Phnom_Penh", flag: "🇰🇭" },
    { name: "Yaoundé", country: "Cameroon", timezone: "Africa/Douala", flag: "🇨🇲" },
    { name: "Ottawa", country: "Canada", timezone: "America/Toronto", flag: "🇨🇦" },
    { name: "Praia", country: "Cape Verde", timezone: "Atlantic/Cape_Verde", flag: "🇨🇻" },
    { name: "Bangui", country: "Central African Republic", timezone: "Africa/Bangui", flag: "🇨🇫" },
    { name: "N'Djamena", country: "Chad", timezone: "Africa/Ndjamena", flag: "🇹🇩" },
    { name: "Moroni", country: "Comoros", timezone: "Indian/Comoro", flag: "🇰🇲" },
    { name: "Kinshasa", country: "DR Congo", timezone: "Africa/Kinshasa", flag: "🇨🇩" },
    { name: "Brazzaville", country: "Republic of the Congo", timezone: "Africa/Brazzaville", flag: "🇨🇬" },
    { name: "San José", country: "Costa Rica", timezone: "America/Costa_Rica", flag: "🇨🇷" },
    { name: "Zagreb", country: "Croatia", timezone: "Europe/Zagreb", flag: "🇭🇷" },
    { name: "Havana", country: "Cuba", timezone: "America/Havana", flag: "🇨🇺" },
    { name: "Nicosia", country: "Cyprus", timezone: "Asia/Nicosia", flag: "🇨🇾" },
    { name: "Tallinn", country: "Estonia", timezone: "Europe/Tallinn", flag: "🇪🇪" },
    { name: "Suva", country: "Fiji", timezone: "Pacific/Fiji", flag: "🇫🇯" },
    { name: "Libreville", country: "Gabon", timezone: "Africa/Libreville", flag: "🇬🇦" },
    { name: "Banjul", country: "Gambia", timezone: "Africa/Banjul", flag: "🇬🇲" },
    { name: "Tbilisi", country: "Georgia", timezone: "Asia/Tbilisi", flag: "🇬🇪" },
    { name: "Accra", country: "Ghana", timezone: "Africa/Accra", flag: "🇬🇭" },
    { name: "Guatemala City", country: "Guatemala", timezone: "America/Guatemala", flag: "🇬🇹" },
    { name: "Conakry", country: "Guinea", timezone: "Africa/Conakry", flag: "🇬🇳" },
    { name: "Bissau", country: "Guinea-Bissau", timezone: "Africa/Bissau", flag: "🇬🇼" },
    { name: "Port-au-Prince", country: "Haiti", timezone: "America/Port-au-Prince", flag: "🇭🇹" },
    { name: "Tegucigalpa", country: "Honduras", timezone: "America/Tegucigalpa", flag: "🇭🇳" },
    { name: "Reykjavik", country: "Iceland", timezone: "Atlantic/Reykjavik", flag: "🇮🇸" },
    { name: "Tehran", country: "Iran", timezone: "Asia/Tehran", flag: "🇮🇷" },
    { name: "Baghdad", country: "Iraq", timezone: "Asia/Baghdad", flag: "🇮🇶" },
    { name: "Jerusalem", country: "Israel", timezone: "Asia/Jerusalem", flag: "🇮🇱" },
    { name: "Amman", country: "Jordan", timezone: "Asia/Amman", flag: "🇯🇴" },
    { name: "Nur-Sultan", country: "Kazakhstan", timezone: "Asia/Almaty", flag: "🇰🇿" },
    { name: "Pristina", country: "Kosovo", timezone: "Europe/Belgrade", flag: "🇽🇰" },
    { name: "Kuwait City", country: "Kuwait", timezone: "Asia/Kuwait", flag: "🇰🇼" },
    { name: "Vientiane", country: "Laos", timezone: "Asia/Vientiane", flag: "🇱🇦" },
    { name: "Riga", country: "Latvia", timezone: "Europe/Riga", flag: "🇱🇻" },
    { name: "Beirut", country: "Lebanon", timezone: "Asia/Beirut", flag: "🇱🇧" },
    { name: "Maseru", country: "Lesotho", timezone: "Africa/Maseru", flag: "🇱🇸" },
    { name: "Monrovia", country: "Liberia", timezone: "Africa/Monrovia", flag: "🇱🇷" },
    { name: "Tripoli", country: "Libya", timezone: "Africa/Tripoli", flag: "🇱🇾" },
    { name: "Vaduz", country: "Liechtenstein", timezone: "Europe/Vaduz", flag: "🇱🇮" },
    { name: "Vilnius", country: "Lithuania", timezone: "Europe/Vilnius", flag: "🇱🇹" },
    { name: "Luxembourg", country: "Luxembourg", timezone: "Europe/Luxembourg", flag: "🇱🇺" },
    { name: "Antananarivo", country: "Madagascar", timezone: "Indian/Antananarivo", flag: "🇲🇬" },
    { name: "Lilongwe", country: "Malawi", timezone: "Africa/Blantyre", flag: "🇲🇼" },
    { name: "Bamako", country: "Mali", timezone: "Africa/Bamako", flag: "🇲🇱" },
    { name: "Valletta", country: "Malta", timezone: "Europe/Malta", flag: "🇲🇹" },
    { name: "Port Louis", country: "Mauritius", timezone: "Indian/Mauritius", flag: "🇲🇺" },
    { name: "Chisinau", country: "Moldova", timezone: "Europe/Chisinau", flag: "🇲🇩" },
    { name: "Ulaanbaatar", country: "Mongolia", timezone: "Asia/Ulaanbaatar", flag: "🇲🇳" },
    { name: "Podgorica", country: "Montenegro", timezone: "Europe/Podgorica", flag: "🇲🇪" },
    { name: "Rabat", country: "Morocco", timezone: "Africa/Casablanca", flag: "🇲🇦" },
    { name: "Maputo", country: "Mozambique", timezone: "Africa/Maputo", flag: "🇲🇿" },
    { name: "Windhoek", country: "Namibia", timezone: "Africa/Windhoek", flag: "🇳🇦" },
    { name: "Kathmandu", country: "Nepal", timezone: "Asia/Kathmandu", flag: "🇳🇵" },
    { name: "Oslo", country: "Norway", timezone: "Europe/Oslo", flag: "🇳🇴" },
    { name: "Muscat", country: "Oman", timezone: "Asia/Muscat", flag: "🇴🇲" },
    { name: "Islamabad", country: "Pakistan", timezone: "Asia/Karachi", flag: "🇵🇰" },
    { name: "Panama City", country: "Panama", timezone: "America/Panama", flag: "🇵🇦" },
    { name: "Asuncion", country: "Paraguay", timezone: "America/Asuncion", flag: "🇵🇾" },
    { name: "Doha", country: "Qatar", timezone: "Asia/Qatar", flag: "🇶🇦" },
    { name: "Bucharest", country: "Romania", timezone: "Europe/Bucharest", flag: "🇷🇴" },
    { name: "Kigali", country: "Rwanda", timezone: "Africa/Kigali", flag: "🇷🇼" },
    { name: "Belgrade", country: "Serbia", timezone: "Europe/Belgrade", flag: "🇷🇸" },
    { name: "Bratislava", country: "Slovakia", timezone: "Europe/Bratislava", flag: "🇸🇰" },
    { name: "Ljubljana", country: "Slovenia", timezone: "Europe/Ljubljana", flag: "🇸🇮" },
    { name: "Honiara", country: "Solomon Islands", timezone: "Pacific/Guadalcanal", flag: "🇸🇧" },
    { name: "Khartoum", country: "Sudan", timezone: "Africa/Khartoum", flag: "🇸🇩" },
    { name: "Paramaribo", country: "Suriname", timezone: "America/Paramaribo", flag: "🇸🇷" },
    { name: "Damascus", country: "Syria", timezone: "Asia/Damascus", flag: "🇸🇾" },
    { name: "Dushanbe", country: "Tajikistan", timezone: "Asia/Dushanbe", flag: "🇹🇯" },
    { name: "Dodoma", country: "Tanzania", timezone: "Africa/Dar_es_Salaam", flag: "🇹🇿" },
    { name: "Tunis", country: "Tunisia", timezone: "Africa/Tunis", flag: "🇹🇳" },
    { name: "Ashgabat", country: "Turkmenistan", timezone: "Asia/Ashgabat", flag: "🇹🇲" },
    { name: "Kampala", country: "Uganda", timezone: "Africa/Kampala", flag: "🇺🇬" },
    { name: "Kyiv", country: "Ukraine", timezone: "Europe/Kyiv", flag: "🇺🇦" },
    { name: "Montevideo", country: "Uruguay", timezone: "America/Montevideo", flag: "🇺🇾" },
    { name: "Tashkent", country: "Uzbekistan", timezone: "Asia/Tashkent", flag: "🇺🇿" },
    { name: "Caracas", country: "Venezuela", timezone: "America/Caracas", flag: "🇻🇪" },
    { name: "Lusaka", country: "Zambia", timezone: "Africa/Lusaka", flag: "🇿🇲" },
    { name: "Harare", country: "Zimbabwe", timezone: "Africa/Harare", flag: "🇿🇼" }
];

const popularCities = [
    { name: "Abu Dhabi", size: 2, timezone: "Asia/Dubai" }, { name: "Addis Ababa", size: 1, timezone: "Africa/Addis_Ababa" }, { name: "Amsterdam", size: 3, timezone: "Europe/Amsterdam" },
    { name: "Beijing", size: 5, timezone: "Asia/Shanghai" }, { name: "Berlin", size: 3, timezone: "Europe/Berlin" },
    { name: "Buenos Aires", size: 4, timezone: "America/Argentina/Buenos_Aires" }, { name: "Cairo", size: 3, timezone: "Africa/Cairo" }, { name: "Chicago", size: 4, timezone: "America/Chicago" }, { name: "Delhi", size: 5, timezone: "Asia/Kolkata" }, { name: "Dhaka", size: 4, timezone: "Asia/Dhaka" },
    { name: "Dubai", size: 4, timezone: "Asia/Dubai" }, { name: "Hong Kong", size: 4, timezone: "Asia/Hong_Kong" }, { name: "Istanbul", size: 5, timezone: "Europe/Istanbul" }, { name: "Jakarta", size: 3, timezone: "Asia/Jakarta" },
    { name: "Karachi", size: 5, timezone: "Asia/Karachi" }, { name: "Lagos", size: 4, timezone: "Africa/Lagos" }, { name: "London", size: 5, timezone: "Europe/London" }, { name: "Los Angeles", size: 5, timezone: "America/Los_Angeles" },
    { name: "Manila", size: 3, timezone: "Asia/Manila" }, { name: "Mexico City", size: 5, timezone: "America/Mexico_City" }, { name: "Moscow", size: 4, timezone: "Europe/Moscow" }, { name: "Mumbai", size: 4, timezone: "Asia/Kolkata" },
    { name: "New York", size: 5, timezone: "America/New_York" }, { name: "Paris", size: 4, timezone: "Europe/Paris" }, { name: "Rio de Janeiro", size: 3, timezone: "America/Sao_Paulo" },
    { name: "Seoul", size: 4, timezone: "Asia/Seoul" }, { name: "Shanghai", size: 4, timezone: "Asia/Shanghai" }, { name: "Singapore", size: 4, timezone: "Asia/Singapore" }, { name: "Sydney", size: 4, timezone: "Australia/Sydney" }, { name: "São Paulo", size: 5, timezone: "America/Sao_Paulo" }, { name: "Taipei", size: 3, timezone: "Asia/Taipei" },
    { name: "Tokyo", size: 5, timezone: "Asia/Tokyo" },
];

const translations = {
    // Updated English translations
    en: { name: "English", ui: { notes: "Notes for", calendar: "Calendar", settings: "Settings", theme: "Theme", autoTheme: "Auto Theme", darkMode: "Dark Mode", format: "Format", layout: "Layout", menu: "Menu", menuBackground: "Show Menu Background", searchLayout: "Top Search Bar", hourFormat: "24-Hour Format", language: "Language", reset: "Reset All Data", allNotes: "All Notes", showAllNotes: "Show All Notes", noNotes: "No notes found.", refreshCards: "Refresh Cards", popularCities: "Most popular timezones and cities" }, placeholders: { search: "Search for a city or country...", notes: "Write something for the selected date..." }, alerts: { resetConfirm: "Are you sure? This will clear all pinned clocks and notes.", noPinned: "Search for a city to pin a clock." }, time: { ahead: "ahead", behind: "behind", same: "Same time" }, calendar: { months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], shortMonths: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dic"], weekdays: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"] } },
    // Updated Bengali translations
    bn: { name: "বাংলা (Bangla)", ui: { notes: "নোট", calendar: "ক্যালেন্ডার", settings: "সেটিংস", theme: "থিম", autoTheme: "স্বয়ংক্রিয় থিম", darkMode: "ডার্ক মোড", format: "ফরম্যাট", layout: "বিন্যাস", menu: "মেনু", menuBackground: "মেনুর পটভূমি দেখান", searchLayout: "শীর্ষ অনুসন্ধান বার", hourFormat: "২৪-ঘন্টা ফরম্যাট", language: "ভাষা", reset: "সব ডেটা রিসেট করুন", allNotes: "সমস্ত নোট", showAllNotes: "সব নোট দেখুন", noNotes: "কোন নোট পাওয়া যায়নি।", refreshCards: "কার্ড রিফ্রেশ করুন", popularCities: "সবচেয়ে জনপ্রিয় টাইমজোন এবং শহর" }, placeholders: { search: "শহর বা দেশ খুঁজুন...", notes: "কিছু লিখুন..." }, alerts: { resetConfirm: "আপনি কি নিশ্চিত? এটি সমস্ত পিন করা ঘড়ি এবং নোট মুছে ফেলবে।", noPinned: "ঘড়ি পিন করতে একটি শহর অনুসন্ধান করুন।" }, time: { ahead: "এগিয়ে", behind: "পিছিয়ে", same: "একই সময়" }, calendar: { months: ["জানুয়ারী", "ফেব্রুয়ারী", "মার্চ", "এপ্রিল", "মে", "জুন", "জুলাই", "আগস্ট", "সেপ্টেম্বর", "অক্টোবর", "নভেম্বর", "ডিসেম্বর"], shortMonths: ["জানু", "ফেব্রু", "মার্চ", "এপ্রিল", "মে", "জুন", "জুলাই", "আগস্ট", "সেপ্টে", "অক্টো", "নভে", "ডিসে"], weekdays: ["রবি", "সোম", "মঙ্গল", "বুধ", "বৃহঃ", " শুক্র", "শনি"] } },
    // Updated Spanish translations
    es: { name: "Español", ui: { notes: "Notes for", calendar: "Calendario", settings: "Ajustes", theme: "Tema", autoTheme: "Tema automático", darkMode: "Modo oscuro", format: "Formato", layout: "Diseño", menu: "Menú", menuBackground: "Mostrar fondo del menú", searchLayout: "Barra de búsqueda superior", hourFormat: "Formato 24 horas", language: "Idioma", reset: "Restablecer datos", allNotes: "Todas las notas", showAllNotes: "Mostrar todas las notas", noNotes: "No se encontraron notas.", refreshCards: "Actualizar Tarjetas", popularCities: "Zonas horarias y ciudades más populares" }, placeholders: { search: "Buscar una ciudad o país...", notes: "Escribe algo para la fecha seleccionada..." }, alerts: { resetConfirm: "¿Estás seguro? Esto borrará todos los relojes y notas fijados.", noPinned: "Busca una ciudad para fijar un reloj." }, time: { ahead: "adelantado", behind: "atrasado", same: "Misma hora" }, calendar: { months: ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"], shortMonths: ["Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"], weekdays: ["Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb"] } }
};

// --- Page Navigation Switching ---
const switchPage = (targetPage) => {
     // Hide all sections
     document.querySelectorAll('.page-section').forEach(section => {
        section.classList.remove('active');
    });

    // Show selected section
    const targetSection = document.getElementById(`page-${targetPage}`);
    if (targetSection) {
        targetSection.classList.add('active');
    }

    // Update nav link active class
    dom.navLinks.forEach(nav => {
        nav.classList.toggle('active', nav.getAttribute('data-page') === targetPage);
    });

    // Close menu
    dom.navOverlay.classList.remove('active');
    dom.menuBtn.classList.remove('active');
}

// --- 2. CORE LOGIC & HELPERS ---

// Helper to get a date string in YYYY-MM-DD format
const getDateString = (date) => {
    return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
};

// Helper to compare if two dates are the same day
const isSameDay = (d1, d2) => {
  return d1.getFullYear() === d2.getFullYear() &&
         d1.getMonth() === d2.getMonth() &&
         d1.getDate() === d2.getDate();
};


// A helper function to prevent a function from being called too frequently.
// Useful for things like search input to avoid making API calls on every keystroke.
const debounce = (func, timeout = 300) => {
    let timer;
    return (...args) => {
        clearTimeout(timer);
        timer = setTimeout(() => { func.apply(this, args); }, timeout);
    };
};

// Fetches time data from the WorldTimeAPI for a given timezone.
// It calculates the 'offset' - the difference between the API's time and the user's browser time.
// This offset is used to calculate the correct time locally without needing to call the API every second.
const createClockObject = async (timezone) => {
    try {
        const response = await fetch(`${API_BASE_URL}/timezone/${timezone}`);
        if (!response.ok) throw new Error(`API fetch failed for ${timezone}`);
        const data = await response.json();
        const cityInfo = cityData.find(c => c.timezone === data.timezone) || {};
        return { ...data, ...cityInfo, offset: new Date(data.utc_datetime).getTime() - Date.now(), apiFailed: false };
    } catch (error) {
        console.warn(`${error.message}. Falling back to browser time.`);
        const cityInfo = cityData.find(c => c.timezone === timezone) || {};
        return { timezone, ...cityInfo, apiFailed: true, offset: 0 };
    }
};

// A helper function to get the current hour (0-23) in a specific timezone.
// This is used to determine if it's day or night for styling the clock cards.
const getHourInTimezone = (date, timezone) => {
    const formatter = new Intl.DateTimeFormat('en-US', {
        hour: 'numeric',
        hour12: false,
        timeZone: timezone,
    });
    return parseInt(formatter.format(date), 10);
};

// The main function that updates all visible clocks every second.
const updateAllClocks = () => {
    const now = Date.now();
    
    // Self-heal main clock if needed
    if (state.mainClock && !state.mainClock.raw_offset && !state.mainClock.isRefreshing) {
        state.mainClock.isRefreshing = true;
        (async () => {
            const refreshedClock = await createClockObject(state.mainClock.timezone);
            state.mainClock = { ...refreshedClock, isRefreshing: false };
        })();
    }

    // Update the main clock
    if (state.mainClock) {
        const mainTime = new Date(now + state.mainClock.offset);
        const formattedTime = formatTime(mainTime, state.mainClock.timezone);
        const formattedDate = formatDate(mainTime, state.mainClock.timezone);

        dom.mainTime.textContent = formattedTime;
        dom.mainDate.textContent = formattedDate;
        
        if (dom.fullscreenOverlay.classList.contains('active')) {
            dom.fullscreenTime.textContent = formattedTime;
            dom.fullscreenDate.textContent = formattedDate;
        }
    }
    
    // Update all the pinned city clocks
    state.pinnedClocks.forEach(clock => {
        const card = document.querySelector(`.clock-card[data-timezone="${clock.timezone}"]`);
        if (card) {
            // Self-healing for pinned clocks
            if (clock.apiFailed && !clock.isRefreshing) {
                clock.isRefreshing = true;
                (async () => {
                    console.log(`Data for ${clock.timezone} is missing. Auto-refreshing...`);
                    const refreshedClock = await createClockObject(clock.timezone);
                    const index = state.pinnedClocks.findIndex(c => c.timezone === refreshedClock.timezone);
                    if (index !== -1) {
                        state.pinnedClocks[index] = { ...refreshedClock, isRefreshing: false };
                    }
                })();
            }

            const clockTime = new Date(now + clock.offset);
            const hourInTimezone = getHourInTimezone(clockTime, clock.timezone);
            const isDay = hourInTimezone >= 6 && hourInTimezone < 18;

            card.querySelector('.time').textContent = formatTime(clockTime, clock.timezone);
            card.querySelector('.date').textContent = formatDate(clockTime, clock.timezone, 'short');
            card.querySelector('.day-night-indicator').textContent = isDay ? '☀️' : '🌙';
            
            card.classList.toggle('card-day', isDay);
            card.classList.toggle('card-night', !isDay);
            
            const timeDifferenceEl = card.querySelector('.time-difference');
            if (timeDifferenceEl) {
                timeDifferenceEl.innerHTML = calculateTimeDifference(clock);
            }
        }
    });

    // Update the countdowns for all active alarms
    updateAlarmCountdowns();
};

// Adds a new city clock to the dashboard.
const addClock = async (timezone) => {
    if (state.pinnedClocks.some(c => c.timezone === timezone)) return; // Avoid duplicates
    const newClock = await createClockObject(timezone);
    if (newClock) {
        state.pinnedClocks.push(newClock);
        renderPinnedClocks();
        saveState();
    }
};

// Removes a city clock from the dashboard.
const removeClock = (timezone) => {
    state.pinnedClocks = state.pinnedClocks.filter(c => c.timezone !== timezone);
    renderPinnedClocks();
    saveState();
};

// Calculates and formats the time difference between a pinned clock and the main clock.
const calculateTimeDifference = (clock) => {
    const t = translations[state.settings.language];
    if (!state.mainClock || clock.raw_offset === undefined || state.mainClock.raw_offset === undefined) {
        return ''; // Not enough data to calculate
    }

    const timezoneInfo = `${clock.abbreviation || ''} UTC${clock.utc_offset}`;
    
    const mainTotalOffsetSeconds = state.mainClock.raw_offset + (state.mainClock.dst_offset || 0);
    const clockTotalOffsetSeconds = clock.raw_offset + (clock.dst_offset || 0);
    const diffSeconds = clockTotalOffsetSeconds - mainTotalOffsetSeconds;
    const diffHours = diffSeconds / 3600;

    let diffFromMainText = '';
    const mainClockName = state.mainClock.name || 'your location';
    if (Math.abs(diffHours) < 0.01) {
        diffFromMainText = ` &nbsp;&nbsp; | &nbsp;&nbsp; ${t.time.same} as ${mainClockName}`;
    } else {
        const behindOrAhead = diffHours < 0 ? t.time.behind : t.time.ahead;
        const hoursDisplay = Math.abs(diffHours).toString().replace('.5', '.5').replace('.0', '');
        diffFromMainText = ` &nbsp;&nbsp; | &nbsp;&nbsp; ${hoursDisplay} hours ${behindOrAhead} ${mainClockName}`;
    }

    return `${timezoneInfo}${diffFromMainText}`;
};

// --- 3. UTILITY (STOPWATCH, TIMER, ALARM) LOGIC ---

// Stopwatch logic
const updateStopwatchDisplay = () => {
    const now = Date.now();
    const time = state.stopwatch.elapsedTime + (state.stopwatch.startTime ? now - state.stopwatch.startTime : 0);
    const ms = Math.floor((time % 1000) / 10).toString().padStart(2, '0');
    const s = Math.floor((time / 1000) % 60).toString().padStart(2, '0');
    const m = Math.floor((time / (1000 * 60)) % 60).toString().padStart(2, '0');
    const h = Math.floor(time / (1000 * 60 * 60)).toString().padStart(2, '0');
    dom.stopwatchDisplay.innerHTML = `${h}:${m}:${s}<span class="milliseconds">.${ms}</span>`;
};

const renderLaps = () => {
    dom.lapsList.innerHTML = '';
    state.stopwatch.laps.forEach((lap, index) => {
        const lapItem = document.createElement('li');
        lapItem.className = 'lap-item';
        lapItem.innerHTML = `<span class="lap-number">Lap ${index + 1}</span><span>${lap.time}</span>`;
        dom.lapsList.prepend(lapItem);
    });
};

// Timer logic
const playTimerSound = () => {
    try {
    const timerSound = new Tone.Player("https://res.cloudinary.com/dhkjgite9/video/upload/v1761238099/alarm_timer_orkjxa.mp3").toDestination();
    Tone.loaded().then(() => {
    timerSound.start();
    });
    // You might still want a fallback alert
    setTimeout(() => alert('⏰ Timer finished!'), 100); // Small delay for sound
    } catch (e) {
        // Fallback to a simple alert if Tone.js fails
        alert('⏰ Timer finished!');
        console.error("Tone.js could not play sound.", e);
    }
};

const updateTimerDisplay = () => {
    const s = state.timer.remainingSeconds;
    const hrs = Math.floor(s / 3600).toString().padStart(2, '0');
    const mins = Math.floor((s % 3600) / 60).toString().padStart(2, '0');
    const secs = Math.floor(s % 60).toString().padStart(2, '0');
    dom.timerDisplay.textContent = `${hrs}:${mins}:${secs}`;
};

// Alarm logic
 const playAlarmSound = (label) => {
    try {
        const alarmSound = new Tone.Player("https://res.cloudinary.com/dhkjgite9/video/upload/v1761238099/alarm_qbd9zp.mp3").toDestination();
        Tone.loaded().then(() => {
        alarmSound.start();
        });
        // Display the alert after a short delay
        setTimeout(() => alert(`⏰ ${label}`), 100);
    } catch(e) { console.error("Tone.js could not play sound.", e); }
    alert(`⏰ ${label}`);
};

 const checkAlarms = () => {
    const now = new Date();
    const currentTime = now.toTimeString().substring(0, 5); // Format: "HH:MM"
    let stateChanged = false;

    state.alarms.forEach(alarm => {
        if (alarm.enabled && alarm.time === currentTime) {
            if (!alarm.triggeredToday) {
                playAlarmSound(alarm.label);
                alarm.triggeredToday = true;
                stateChanged = true;
            }
        } else {
            if (alarm.triggeredToday) {
               alarm.triggeredToday = false; // Reset for the next day
               stateChanged = true;
            }
        }
    });

    if (stateChanged) saveState();
};

// This function calculates and displays the remaining time for each alarm.
const updateAlarmCountdowns = () => {
    const now = new Date();
    state.alarms.forEach(alarm => {
        const countdownEl = document.querySelector(`.alarm-card[data-id="${alarm.id}"] .alarm-countdown`);
        if (!countdownEl) return;

        if (!alarm.enabled) {
            countdownEl.textContent = ''; // Clear countdown if alarm is off
            return;
        }

        const [hours, minutes] = alarm.time.split(':');
        let alarmTime = new Date();
        alarmTime.setHours(hours, minutes, 0, 0);

        // If the alarm time for today has already passed, set it for tomorrow
        if (alarmTime < now) {
            alarmTime.setDate(alarmTime.getDate() + 1);
        }

        const diff = alarmTime - now; // Difference in milliseconds
        if (diff > 0) {
            const h = Math.floor(diff / 1000 / 60 / 60);
            const m = Math.floor((diff / 1000 / 60) % 60);
            const s = Math.floor((diff / 1000) % 60);
            countdownEl.textContent = `Rings in ${h}h ${m}m ${s}s`;
        } else {
            countdownEl.textContent = '';
        }
    });
};

// --- 4. UI RENDERING & FORMATTING ---

const updateNotesSection = () => {
    const t = translations[state.settings.language];
    const selectedDateString = getDateString(state.selectedDate);
    const formattedDate = state.selectedDate.toLocaleDateString(state.settings.language, {
        year: 'numeric', month: 'long', day: 'numeric'
    });
    
    dom.uiText.notesTitle.textContent = `${t.ui.notes} ${formattedDate}`;
    dom.notesArea.value = state.notes[selectedDateString] || '';
    dom.notesArea.placeholder = t.placeholders.notes;
};

// Renders the list of alarms from the state.
const renderAlarms = () => {
    dom.alarmsList.innerHTML = '';
    if (!state.alarms) state.alarms = []; // Ensure alarms is an array
    state.alarms.forEach((alarm) => {
        const li = document.createElement('li');
        li.className = 'alarm-item';

        const card = document.createElement('div');
        card.className = `alarm-card ${alarm.enabled ? '' : 'disabled'}`;
        card.dataset.id = alarm.id;

        // The HTML for each alarm card, now including the countdown element.
        card.innerHTML = `
            <div class="alarm-card-details">
                <div class="alarm-card-time">${alarm.time}</div>
                <div class="alarm-card-label">${alarm.label}</div>
                <div class="alarm-countdown"></div>
            </div>
            <div class="alarm-card-controls">
                <label class="toggle-switch">
                    <input type="checkbox" class="alarm-toggle-cb" ${alarm.enabled ? 'checked' : ''}>
                    <span class="slider"></span>
                </label>
                <button class="delete-alarm-btn">✕</button>
            </div>
        `;
        li.appendChild(card);
        dom.alarmsList.appendChild(li);
    });
    updateAlarmCountdowns(); // Update countdowns immediately after rendering
};

// Renders the grid of pinned city clocks.
const renderPinnedClocks = () => {
    dom.clocksGrid.innerHTML = '';
    const t = translations[state.settings.language];

    if (state.pinnedClocks.length === 0) {
        dom.clocksGrid.innerHTML = `<p style="opacity: 0.7; grid-column: 1 / -1; text-align: center;">${t.alerts.noPinned}</p>`;
        return;
    }
    state.pinnedClocks.forEach(clock => {
        const card = document.createElement('div');
        card.className = 'clock-card';
        card.dataset.timezone = clock.timezone;
        
        card.innerHTML = `
            <div class="day-night-indicator"></div>
            <button class="remove-card-btn">✕</button>
            <div class="clock-card-header">
                <div class="clock-card-title">
                    <span class="flag">${clock.flag || '🌐'}</span>
                    <span class="city-name">${clock.name || clock.timezone.split('/').pop().replace(/_/g, ' ')}</span>
                </div>
            </div>
            <div class="time">--:--:--</div>
            <div class="date">Loading...</div>
            <div class="time-difference"></div>
        `;
        dom.clocksGrid.appendChild(card);
        card.querySelector('.remove-card-btn').addEventListener('click', () => removeClock(clock.timezone));
    });
    updateAllClocks(); // Call once to populate initial data immediately
};

const renderRecentNotes = () => {
    const container = dom.recentNotesContainer;
    container.innerHTML = '';

    // --- Responsive Circle Calculation ---
    // First, get all notes that have content, sorted by most recent
    const allSortedNoteKeys = Object.keys(state.notes)
        .filter(key => state.notes[key] && state.notes[key].trim())
        .sort((a, b) => new Date(b) - new Date(a)); // Sort descending

    // Calculate how many circles can fit
    const containerWidth = container.clientWidth;
    const circleWidth = 24; // 24px width from .note-circle
    const circleGap = 4;    // 0.25rem gap from .recent-notes-container
    const maxCircles = Math.floor(containerWidth / (circleWidth + circleGap));
    
    // Slice the array to get only the notes that can fit
    const keysToRender = allSortedNoteKeys.slice(0, maxCircles);
    // --- End of Responsive Calculation ---

    keysToRender.forEach(dateKey => {
        // This part remains the same, just iterating over keysToRender
        if (state.notes[dateKey] && state.notes[dateKey].trim()) {
            const date = new Date(dateKey + 'T00:00:00');
            const day = date.getDate();
            const circle = document.createElement('div');
            circle.className = 'note-circle';
            circle.textContent = day;
            circle.title = `Note from ${date.toLocaleDateString(state.settings.language, { month: 'short', day: 'numeric' })}`;
            circle.addEventListener('click', () => {
                state.currentCalendarDate = new Date(date);
                state.selectedDate = new Date(date);
                renderCalendar();
                updateNotesSection();
            });
            container.appendChild(circle);
        }
    });
}


const renderCalendar = () => {
    const date = state.currentCalendarDate;
    const year = date.getFullYear();
    const month = date.getMonth();
    const t = translations[state.settings.language].calendar;

    dom.calendarTitleText.textContent = `${t.months[month]} ${year}`;
    
    dom.calendarGrid.innerHTML = '';
    
    // Create header row
    const headerRow = document.createElement('div');
    headerRow.style.gridColumn = '1 / -1';
    headerRow.style.display = 'grid';
    headerRow.style.gridTemplateColumns = 'repeat(7, 1fr)';
    headerRow.style.marginBottom = '0.5rem';
    t.weekdays.forEach(day => {
        headerRow.innerHTML += `<div class="calendar-day-header">${day}</div>`;
    });
    dom.calendarGrid.appendChild(headerRow);


    const firstDayOfMonth = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    
    for (let i = 0; i < firstDayOfMonth; i++) {
        dom.calendarGrid.innerHTML += `<div></div>`;
    }

    const today = new Date();
    for (let i = 1; i <= daysInMonth; i++) {
        const dayEl = document.createElement('div');
        const thisDate = new Date(year, month, i);
        const dateString = getDateString(thisDate);

        dayEl.className = 'calendar-day';
        dayEl.textContent = i;
        dayEl.dataset.date = dateString;

        if (isSameDay(thisDate, today)) {
            dayEl.classList.add('today');
        }
        if (isSameDay(thisDate, state.selectedDate)) {
            dayEl.classList.add('selected');
        }
        if (state.notes[dateString]) {
            dayEl.classList.add('has-note');
        }

        dom.calendarGrid.appendChild(dayEl);
    }
    renderRecentNotes();
};

const renderDatePicker = (targetYear) => {
    const t = translations[state.settings.language].calendar;
    dom.pickerYearInput.value = targetYear;
    dom.datePickerMonthsGrid.innerHTML = '';

    t.shortMonths.forEach((monthName, index) => {
        const monthBtn = document.createElement('button');
        monthBtn.className = 'month-btn';
        monthBtn.textContent = monthName;
        monthBtn.dataset.month = index;
        
        if (index === state.currentCalendarDate.getMonth() && targetYear === state.currentCalendarDate.getFullYear()) {
            monthBtn.classList.add('active');
        }
        
        monthBtn.addEventListener('click', () => {
            state.currentCalendarDate.setFullYear(targetYear, index, 1);
            renderCalendar();
            dom.datePickerModal.classList.remove('active');
        });
        dom.datePickerMonthsGrid.appendChild(monthBtn);
    });
};

const renderPopularCities = () => {
    const cityCloud = document.getElementById('city-cloud');
    if (!cityCloud) return;
    cityCloud.innerHTML = '';

    popularCities.forEach(city => {
        const citySpan = document.createElement('span');
        citySpan.textContent = city.name;
        citySpan.className = `city-item size-${city.size}`;
        citySpan.addEventListener('click', () => addClock(city.timezone));
        cityCloud.appendChild(citySpan);
    });
};

const renderAllNotesModal = () => {
    const t = translations[state.settings.language];
    dom.allNotesContent.innerHTML = '';
    const sortedNoteKeys = Object.keys(state.notes).sort();

    if (sortedNoteKeys.length === 0) {
        dom.allNotesContent.textContent = t.ui.noNotes;
        return;
    }

    sortedNoteKeys.forEach(dateKey => {
        const noteText = state.notes[dateKey];
        if (noteText && noteText.trim()) {
            const noteEntry = document.createElement('div');
            noteEntry.className = 'note-entry';
            noteEntry.dataset.date = dateKey; // Store date key
            
            const noteHeader = document.createElement('div');
            noteHeader.className = 'note-header';

            const noteDate = document.createElement('div');
            noteDate.className = 'note-date';
            const date = new Date(dateKey + 'T00:00:00');
            noteDate.textContent = date.toLocaleDateString(state.settings.language, {
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
            });

            const noteControls = document.createElement('div');
            noteControls.className = 'note-controls';
            noteControls.innerHTML = `
                <button class="note-action-btn edit-note-btn">Edit</button>
                <button class="note-action-btn save-note-btn" style="display: none;">Save</button>
            `;
            
            noteHeader.appendChild(noteDate);
            noteHeader.appendChild(noteControls);

            const noteContent = document.createElement('div');
            noteContent.className = 'note-text';
            noteContent.textContent = noteText;

            noteEntry.appendChild(noteHeader);
            noteEntry.appendChild(noteContent);
            dom.allNotesContent.appendChild(noteEntry);
        }
    });
};

const applyTheme = () => {
    if (state.settings.autoTheme) {
        if (state.mainClock) {
            const hour = getHourInTimezone(new Date(Date.now() + state.mainClock.offset), state.mainClock.timezone);
            dom.body.className = (hour >= 6 && hour < 18) ? 'light-theme' : 'dark-theme';
        } else {
            dom.body.className = 'light-theme';
        }
    } else {
        dom.body.className = state.settings.manualThemeDark ? 'dark-theme' : 'light-theme';
    }
}

const applySearchLayout = () => {
    if (state.settings.searchLayout === 'top') {
        document.body.classList.add('top-search-layout');
        document.body.classList.remove('middle-search-layout');
        dom.searchContainer.style.display = 'none'; // Use display:none to remove from layout
        dom.topSearchContainer.style.display = 'block';
        dom.searchBtn.style.display = 'flex';
    } else {
        document.body.classList.remove('top-search-layout');
        document.body.classList.add('middle-search-layout');
        dom.searchContainer.style.display = 'block';
        dom.searchContainer.classList.add('active');
        dom.topSearchContainer.style.display = 'none';
        dom.searchBtn.style.display = 'none';
        dom.topSearchContainer.classList.remove('active');
    }
}

const applyMenuBackground = () => {
    dom.navMenu.classList.toggle('liquid-glass', state.settings.menuBackground);
    dom.settingsModal.querySelector('.modal-content').classList.toggle('liquid-glass', state.settings.menuBackground);
}


const applyLanguage = () => {
    const lang = state.settings.language;
    const t = translations[lang];
    
    updateNotesSection();
    dom.uiText.calendarSectionTitle.textContent = t.ui.calendar;
    dom.uiText.settingsModalTitle.textContent = t.ui.settings;
    dom.uiText.themeSettingsTitle.textContent = t.ui.theme;
    dom.uiText.autoThemeLabel.textContent = t.ui.autoTheme;
    dom.uiText.darkThemeLabel.textContent = t.ui.darkMode;
    dom.uiText.formatSettingsTitle.textContent = t.ui.format;
    dom.uiText.hourFormatLabel.textContent = t.ui.hourFormat;
    dom.uiText.layoutSettingsTitle.textContent = t.ui.layout;
    dom.uiText.searchLayoutLabel.textContent = t.ui.searchLayout;
    if (dom.uiText.menuBackgroundLabel) dom.uiText.menuBackgroundLabel.textContent = t.ui.menuBackground;
    dom.uiText.languageSettingsTitle.textContent = t.ui.language;
    dom.uiText.allNotesTitle.textContent = t.ui.allNotes;
    dom.uiText.showAllNotesBtn.textContent = t.ui.showAllNotes;
    // Added lines to apply new translations
    dom.uiText.refreshCardsBtn.textContent = t.ui.refreshCards;
    dom.uiText.popularCitiesTitle.textContent = t.ui.popularCities;


    dom.citySearchInputs.forEach(input => input.placeholder = t.placeholders.search);
    dom.resetBtn.textContent = t.ui.reset;
    
    renderCalendar();
    renderPinnedClocks();
    renderPopularCities();
};

const formatTime = (date, timezone) => {
    const locale = state.settings.language === 'bn' ? 'bn-BD' : state.settings.language;
    return date.toLocaleTimeString(locale, {
        timeZone: timezone,
        hour12: !state.settings.is24Hour,
        hour: '2-digit', minute: '2-digit', second: '2-digit'
    });
};

const formatDate = (date, timezone, format = 'long') => {
    const locale = state.settings.language === 'bn' ? 'bn-BD' : state.settings.language;
    return date.toLocaleDateString(locale, {
        timeZone: timezone,
        weekday: format, year: 'numeric', month: format, day: 'numeric'
    });
};

// --- QUOTE LOGIC ---
const getDayOfYear = (date) => {
    const start = new Date(date.getFullYear(), 0, 0);
    const diff = date - start;
    const oneDay = 1000 * 60 * 60 * 24;
    return Math.floor(diff / oneDay);
};

function changeQuote() {
    const today = new Date();
    const dayOfYear = getDayOfYear(today);
    const quoteIndex = dayOfYear % quotes.length;
    const newQuote = quotes[quoteIndex];

    dom.quoteText.textContent = newQuote.text;
    dom.quoteAuthor.textContent = `– ${newQuote.author}`;
    const cursorEl = dom.quoteContainer.querySelector('.cursor');
    if (cursorEl) {
        cursorEl.style.display = 'none'; // Ensure cursor is always hidden
    }
}


// --- Sound Player & Focus Mode Logic ---
const setupSoundPlayer = () => {
    const soundButtons = document.querySelectorAll('.sound-btn');
    
    soundButtons.forEach(button => {
        button.addEventListener('click', () => {
            const audioSrc = button.dataset.audio;

            if (state.currentlyPlayingButton === button) {
                dom.ambientAudioPlayer.pause();
                dom.ambientAudioPlayer.src = '';
                button.classList.remove('active');
                state.currentlyPlayingButton = null;
            } else {
                if (state.currentlyPlayingButton) {
                    state.currentlyPlayingButton.classList.remove('active');
                }
                dom.ambientAudioPlayer.src = audioSrc;
                dom.ambientAudioPlayer.play();
                button.classList.add('active');
                state.currentlyPlayingButton = button;
            }
        });
    });
};

const downloadAllNotes = () => {
    let content = "AIRCLOCK NOTES\n==================\n\n";
    const sortedNoteKeys = Object.keys(state.notes).sort();
    
    sortedNoteKeys.forEach(dateKey => {
        const noteText = state.notes[dateKey];
        if (noteText && noteText.trim()) {
            const date = new Date(dateKey + 'T00:00:00');
            const formattedDate = date.toLocaleDateString(state.settings.language, {
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
            });
            content += `${formattedDate} - ${noteText}\n\n------------------\n\n`;
        }
    });

    if (sortedNoteKeys.length === 0) {
        content += "No notes found.";
    }

    const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'airclock_notes.txt';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(a.href);
};

const setupEventListeners = () => {
    const toggleModal = (modal, show) => {
        modal.classList.toggle('active', show);
        if (modal === dom.navOverlay) {
            dom.menuBtn.classList.toggle('active', show);
        }
    };
    
    dom.navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            const targetPage = e.target.getAttribute('data-page');
            switchPage(targetPage);
        });
    });

    dom.logoLink.addEventListener('click', () => switchPage('time'));
    dom.footerLogoLink.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });
    
    dom.mainClockContainer.addEventListener('click', (e) => {
        if (e.target.closest('.sound-btn')) {
            return;
        }
        if (state.currentlyPlayingButton) {
            const videoSrc = state.currentlyPlayingButton.dataset.video;
            dom.fullscreenVideoPlayer.src = videoSrc;
            dom.fullscreenVideoPlayer.play();
            dom.fullscreenOverlay.classList.add('focus-active');
        }
        toggleModal(dom.fullscreenOverlay, true);
        
        dom.fullscreenHint.classList.add('visible');
        setTimeout(() => {
            dom.fullscreenHint.classList.remove('visible');
        }, 4000);
    });

    dom.fullscreenOverlay.addEventListener('click', (e) => {
        toggleModal(dom.fullscreenOverlay, false);
        dom.fullscreenVideoPlayer.pause();
        dom.fullscreenVideoPlayer.src = '';
        dom.fullscreenOverlay.classList.remove('focus-active');
    });
    
    dom.searchBtn.addEventListener('click', () => {
        dom.topSearchContainer.classList.toggle('active');
        if (dom.topSearchContainer.classList.contains('active')) {
           dom.topSearchContainer.querySelector('.city-search-input').focus();
        }
    });

    dom.settingsBtn.addEventListener('click', () => toggleModal(dom.settingsModal, true));
    dom.closeSettingsBtn.addEventListener('click', () => toggleModal(dom.settingsModal, false));
    dom.menuBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        toggleModal(dom.navOverlay, !dom.navOverlay.classList.contains('active'));
    });

    dom.calendarTitleText.addEventListener('click', () => {
        renderDatePicker(state.currentCalendarDate.getFullYear());
        toggleModal(dom.datePickerModal, true);
    });
    dom.closeDatePickerBtn.addEventListener('click', () => toggleModal(dom.datePickerModal, false));
    
    dom.showAllNotesBtn.addEventListener('click', () => {
        renderAllNotesModal();
        toggleModal(dom.allNotesModal, true);
    });
    dom.closeAllNotesBtn.addEventListener('click', () => toggleModal(dom.allNotesModal, false));
    dom.downloadNotesBtn.addEventListener('click', downloadAllNotes);
    
    [dom.settingsModal, dom.datePickerModal, dom.navOverlay, dom.allNotesModal].forEach(modal => {
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                toggleModal(modal, false);
            }
        });
    });

    dom.prevYearBtn.addEventListener('click', () => {
        const newYear = parseInt(dom.pickerYearInput.value) - 1;
        renderDatePicker(newYear);
    });
    dom.nextYearBtn.addEventListener('click', () => {
        const newYear = parseInt(dom.pickerYearInput.value) + 1;
        renderDatePicker(newYear);
    });
    dom.pickerYearInput.addEventListener('change', () => {
        const newYear = parseInt(dom.pickerYearInput.value);
        if (!isNaN(newYear)) {
            renderDatePicker(newYear);
        } else {
            renderDatePicker(state.currentCalendarDate.getFullYear());
        }
    });

    document.addEventListener('keydown', (e) => {
        if (e.shiftKey && (e.key === 'F' || e.key === 'f')) {
            if (dom.fullscreenOverlay.classList.contains('active')) {
                e.preventDefault(); 
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(err => {
                        console.error(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
                    });
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    }
                }
            }
        }
        if (e.key === "Escape") {
            if (document.fullscreenElement) {
                document.exitFullscreen();
            }
            [dom.fullscreenOverlay, dom.settingsModal, dom.navOverlay, dom.datePickerModal, dom.allNotesModal].forEach(modal => {
                 if(modal.classList.contains('active')) {
                     toggleModal(modal, false);
                     if(modal === dom.fullscreenOverlay) {
                         dom.fullscreenVideoPlayer.pause();
                         dom.fullscreenVideoPlayer.src = '';
                         dom.fullscreenOverlay.classList.remove('focus-active');
                     }
                 }
            });
        }
    });

    dom.autoThemeToggle.addEventListener('change', (e) => {
        state.settings.autoTheme = e.target.checked;
        if(e.target.checked) {
            state.settings.manualThemeDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        }
        applyTheme();
        saveState();
    });
    dom.manualThemeToggle.addEventListener('change', (e) => {
        state.settings.autoTheme = false;
        dom.autoThemeToggle.checked = false;
        state.settings.manualThemeDark = e.target.checked;
        applyTheme();
        saveState();
    });
    
    dom.hourFormatToggle.addEventListener('change', (e) => {
        state.settings.is24Hour = e.target.checked;
        updateAllClocks();
        saveState();
    });
    dom.searchLayoutToggle.addEventListener('change', (e) => {
        state.settings.searchLayout = e.target.checked ? 'top' : 'middle';
        applySearchLayout();
        saveState();
    });
     dom.menuBackgroundToggle.addEventListener('change', (e) => {
        state.settings.menuBackground = e.target.checked;
        applyMenuBackground();
        saveState();
    });
    dom.languageSelect.addEventListener('change', (e) => {
        state.settings.language = e.target.value;
        applyLanguage();
        saveState();
    });
    
    dom.langLinkBangla.addEventListener('click', (e) => {
        e.preventDefault();
        state.settings.language = 'bn';
        dom.languageSelect.value = 'bn';
        applyLanguage();
        saveState();
    });

    const handleSearchInput = (e) => {
        const input = e.target;
        const dropdown = input.nextElementSibling;
        const query = input.value.toLowerCase();
        
        dropdown.innerHTML = '';
        if (query) {
            const filteredCities = cityData.filter(c => 
                c.name.toLowerCase().includes(query) || 
                c.country.toLowerCase().includes(query)
            );
            filteredCities.forEach(city => {
                const item = document.createElement('div');
                item.className = 'search-dropdown-item';
                item.innerHTML = `<span class="flag">${city.flag}</span> <span class="city-name">${city.name}</span>`;
                item.addEventListener('click', () => {
                    addClock(city.timezone);
                    input.value = '';
                    dropdown.classList.remove('active');
                });
                dropdown.appendChild(item);
            });
            dropdown.classList.toggle('active', filteredCities.length > 0);
        } else {
            dropdown.classList.remove('active');
        }
    };

    dom.citySearchInputs.forEach(input => {
        input.addEventListener('input', debounce(handleSearchInput, 300));
    });

    document.addEventListener('click', (e) => {
        document.querySelectorAll('.search-dropdown.active').forEach(dropdown => {
             if (!e.target.closest('.search-container')) {
                dropdown.classList.remove('active');
            }
        });
        if (!e.target.closest('#topSearchContainer') && e.target !== dom.searchBtn && !dom.searchBtn.contains(e.target)) {
             dom.topSearchContainer.classList.remove('active');
        }
    });

    dom.popularCitiesContainer.querySelectorAll('.timezone-item').forEach(item => {
        item.addEventListener('click', () => {
            const tz = item.textContent;
            let ianaTimezone;
            switch(tz) {
                case 'UTC': ianaTimezone = 'Etc/UTC'; break;
                case 'GMT': ianaTimezone = 'Etc/GMT'; break;
                case 'CET': ianaTimezone = 'CET'; break;
                case 'Pacific Time': ianaTimezone = 'America/Los_Angeles'; break;
                case 'Mountain Time': ianaTimezone = 'America/Denver'; break;
                case 'Central Time': ianaTimezone = 'America/Chicago'; break;
                case 'Eastern Time': ianaTimezone = 'America/New_York'; break;
                case 'China Standard Time': ianaTimezone = 'Asia/Shanghai'; break;
                case 'India Standard Time': ianaTimezone = 'Asia/Kolkata'; break;
                default: return;
            }
            addClock(ianaTimezone);
        });
    });

    dom.notesArea.addEventListener('input', debounce(() => {
        const selectedDateString = getDateString(state.selectedDate);
        const noteText = dom.notesArea.value;

        if (noteText.trim()) {
            state.notes[selectedDateString] = noteText;
        } else {
            delete state.notes[selectedDateString];
        }
        renderCalendar();
        saveState();
    }, 500));

    dom.resetBtn.addEventListener('click', () => {
        const t = translations[state.settings.language];
        if (window.confirm(t.alerts.resetConfirm)) {
            localStorage.removeItem('airclockState');
            window.location.reload();
        }
    });
    
    dom.refreshCardsBtn.addEventListener('click', async () => {
        dom.refreshCardsBtn.disabled = true;
        const timezonesToRefresh = [
            state.mainClock.timezone,
            ...state.pinnedClocks.map(c => c.timezone)
        ];
        const uniqueTimezones = [...new Set(timezonesToRefresh)];
        const refreshPromises = uniqueTimezones.map(tz => createClockObject(tz));
        const refreshedClocks = await Promise.all(refreshPromises);

        refreshedClocks.forEach(refreshedClock => {
            if (refreshedClock.timezone === state.mainClock.timezone) {
                state.mainClock = { ...state.mainClock, ...refreshedClock };
            }
            const index = state.pinnedClocks.findIndex(c => c.timezone === refreshedClock.timezone);
            if (index !== -1) {
                state.pinnedClocks[index] = refreshedClock;
            }
        });

        renderPinnedClocks();
        saveState();
        dom.refreshCardsBtn.disabled = false;
    });

    dom.prevMonthBtn.addEventListener('click', () => {
        state.currentCalendarDate.setMonth(state.currentCalendarDate.getMonth() - 1);
        renderCalendar();
    });
    dom.nextMonthBtn.addEventListener('click', () => {
        state.currentCalendarDate.setMonth(state.currentCalendarDate.getMonth() + 1);
        renderCalendar();
    });
    
    dom.calendarGrid.addEventListener('click', (e) => {
        const dayEl = e.target.closest('.calendar-day');
        if (dayEl && dayEl.dataset.date) {
            state.selectedDate = new Date(dayEl.dataset.date + 'T00:00:00');
            renderCalendar();
            updateNotesSection();
        }
    });

    dom.stopwatchToggleBtn.addEventListener('click', () => {
        if (state.stopwatch.intervalId) {
            clearInterval(state.stopwatch.intervalId);
            state.stopwatch.elapsedTime += Date.now() - state.stopwatch.startTime;
            state.stopwatch.intervalId = null;
            state.stopwatch.startTime = 0;
            dom.stopwatchToggleBtn.textContent = 'Start';
            dom.stopwatchToggleBtn.classList.replace('stop-btn', 'start-btn');
        } else {
            state.stopwatch.startTime = Date.now();
            state.stopwatch.intervalId = setInterval(updateStopwatchDisplay, 10);
            dom.stopwatchToggleBtn.textContent = 'Stop';
            dom.stopwatchToggleBtn.classList.replace('start-btn', 'stop-btn');
        }
    });

    dom.stopwatchResetBtn.addEventListener('click', () => {
        clearInterval(state.stopwatch.intervalId);
        state.stopwatch = { startTime: 0, elapsedTime: 0, intervalId: null, laps: [] };
        dom.stopwatchDisplay.innerHTML = `00:00:00<span class="milliseconds">.00</span>`;
        renderLaps();
        dom.stopwatchToggleBtn.textContent = 'Start';
        dom.stopwatchToggleBtn.classList.replace('stop-btn', 'start-btn');
    });

    dom.stopwatchLapBtn.addEventListener('click', () => {
        if (state.stopwatch.intervalId) {
            const lapTime = dom.stopwatchDisplay.innerHTML;
            state.stopwatch.laps.push({ time: lapTime });
            renderLaps();
        }
    });

    dom.timerToggleBtn.addEventListener('click', () => {
        if (state.timer.intervalId) {
            clearInterval(state.timer.intervalId);
            state.timer.intervalId = null;
            dom.timerInputsContainer.style.display = 'flex';
            dom.timerToggleBtn.textContent = 'Start';
            dom.timerToggleBtn.classList.replace('stop-btn', 'start-btn');
        } else {
            let totalSeconds = parseInt(dom.timerHoursInput.value) * 3600 +
                               parseInt(dom.timerMinutesInput.value) * 60 +
                               parseInt(dom.timerSecondsInput.value);

            if (totalSeconds <= 0) return;
            
            state.timer.remainingSeconds = totalSeconds;
            dom.timerInputsContainer.style.display = 'none';
            updateTimerDisplay();
            dom.timerToggleBtn.textContent = 'Stop';
            dom.timerToggleBtn.classList.replace('start-btn', 'stop-btn');

            state.timer.intervalId = setInterval(() => {
                state.timer.remainingSeconds--;
                updateTimerDisplay();
                if (state.timer.remainingSeconds <= 0) {
                    clearInterval(state.timer.intervalId);
                    state.timer.intervalId = null;
                    dom.timerInputsContainer.style.display = 'flex';
                    dom.timerToggleBtn.textContent = 'Start';
                    dom.timerToggleBtn.classList.replace('stop-btn', 'start-btn');
                    playTimerSound();
                }
            }, 1000);
        }
    });

    dom.timerResetBtn.addEventListener('click', () => {
        if (state.timer.intervalId) clearInterval(state.timer.intervalId);
        state.timer = { totalSeconds: 0, remainingSeconds: 0, intervalId: null };
        dom.timerHoursInput.value = "0";
        dom.timerMinutesInput.value = "10";
        dom.timerSecondsInput.value = "0";
        dom.timerInputsContainer.style.display = 'flex';
        updateTimerDisplay();
        dom.timerToggleBtn.textContent = 'Start';
        dom.timerToggleBtn.classList.replace('stop-btn', 'start-btn');
    });
    
    dom.addAlarmBtn.addEventListener('click', () => {
        const time = dom.alarmTimeInput.value;
        const label = dom.alarmLabelInput.value.trim() || 'Alarm';
        if (!time || state.alarms.some(a => a.time === time)) return;

        const newAlarm = { id: Date.now(), time, label, enabled: true, triggeredToday: false };
        state.alarms.push(newAlarm);
        
        dom.alarmTimeInput.value = '';
        dom.alarmLabelInput.value = '';

        renderAlarms();
        saveState();
    });
    
    dom.alarmsList.addEventListener('click', (e) => {
        const alarmCard = e.target.closest('.alarm-card');
        if (!alarmCard) return;

        const alarmId = parseInt(alarmCard.dataset.id);
        const alarm = state.alarms.find(a => a.id === alarmId);
        if (!alarm) return;

        if (e.target.classList.contains('delete-alarm-btn')) {
            state.alarms = state.alarms.filter(a => a.id !== alarmId);
            renderAlarms();
        } 
        else if (e.target.classList.contains('alarm-toggle-cb')) {
            alarm.enabled = e.target.checked;
            alarmCard.classList.toggle('disabled', !alarm.enabled);
            updateAlarmCountdowns();
        }
        saveState();
    });

    dom.allNotesContent.addEventListener('click', (e) => {
        const target = e.target;
        const noteEntry = target.closest('.note-entry');
        if (!noteEntry) return;

        const dateKey = noteEntry.dataset.date;
        const editBtn = noteEntry.querySelector('.edit-note-btn');
        const saveBtn = noteEntry.querySelector('.save-note-btn');
        const noteTextDiv = noteEntry.querySelector('.note-text');

        if (target.classList.contains('edit-note-btn')) {
            // Enter edit mode
            const currentText = noteTextDiv.textContent;
            const textArea = document.createElement('textarea');
            textArea.className = 'note-text-edit';
            textArea.value = currentText;
            
            noteEntry.replaceChild(textArea, noteTextDiv);
            textArea.focus();
            
            editBtn.style.display = 'none';
            saveBtn.style.display = 'inline-block';

        } else if (target.classList.contains('save-note-btn')) {
            // Save text
            const textArea = noteEntry.querySelector('.note-text-edit');
            const newText = textArea.value.trim();

            if (newText) {
                state.notes[dateKey] = newText;
            } else {
                delete state.notes[dateKey]; // Delete note if empty
            }
            
            saveState();
            renderCalendar(); // Update main calendar for indicators

            const newNoteTextDiv = document.createElement('div');
            newNoteTextDiv.className = 'note-text';
            newNoteTextDiv.textContent = newText;
            
            noteEntry.replaceChild(newNoteTextDiv, textArea);

            editBtn.style.display = 'inline-block';
            saveBtn.style.display = 'none';

            if (!newText) {
                noteEntry.remove(); // Remove the entry from the modal if note was deleted
            }
        }
    });
};

const saveState = () => {
    const stateToSave = {
        pinnedTimezones: state.pinnedClocks.map(c => c.timezone),
        notes: state.notes,
        settings: state.settings,
        alarms: state.alarms
    };
    localStorage.setItem('airclockState', JSON.stringify(stateToSave));
};

const loadState = async () => {
    const savedState = JSON.parse(localStorage.getItem('airclockState'));
    if (savedState) {
        state.notes = savedState.notes || {};
        // Merge settings, but keep the new defaults if they don't exist in savedState
        state.settings = { ...state.settings, ...savedState.settings };
        state.alarms = savedState.alarms ? savedState.alarms.map(a => ({...a, enabled: a.enabled !== false, triggeredToday: false })) : [];
        
        if (savedState.pinnedTimezones && savedState.pinnedTimezones.length > 0) {
           const clockPromises = savedState.pinnedTimezones.map(timezone => createClockObject(timezone));
           const loadedClocks = await Promise.all(clockPromises);
           state.pinnedClocks = loadedClocks.filter(clock => clock);
        }
    }
};

const populateLanguageSelector = () => {
    dom.languageSelect.innerHTML = '';
    for(const langCode in translations) {
        const option = document.createElement('option');
        option.value = langCode;
        option.textContent = translations[langCode].name;
        dom.languageSelect.appendChild(option);
    }
}

const init = async () => {
    populateLanguageSelector();
    await loadState();
    
    dom.autoThemeToggle.checked = state.settings.autoTheme;
    dom.manualThemeToggle.checked = state.settings.manualThemeDark;
    dom.hourFormatToggle.checked = state.settings.is24Hour;
    dom.searchLayoutToggle.checked = state.settings.searchLayout === 'top';
    dom.menuBackgroundToggle.checked = state.settings.menuBackground;
    dom.languageSelect.value = state.settings.language;

    applySearchLayout();
    applyMenuBackground();
    applyLanguage();
    renderAlarms();
    
    let initialTimezone;
    try {
        const response = await fetch(`${API_BASE_URL}/ip`);
        if (!response.ok) throw new Error("IP API failed");
        initialTimezone = (await response.json()).timezone;
    } catch (e) {
        console.warn("IP lookup failed. Using browser's local timezone as fallback.");
        initialTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
    }

    state.mainClock = await createClockObject(initialTimezone);
    if(state.mainClock) {
        const mainCity = cityData.find(c => c.timezone === state.mainClock.timezone);
        state.mainClock.name = mainCity ? mainCity.name : state.mainClock.timezone.split('/').pop().replace(/_/g, ' ');
        dom.mainLocation.textContent = state.mainClock.timezone.replace(/_/g, ' ');
    }
    
    applyTheme();
    renderPinnedClocks();
    setupEventListeners();
    setupSoundPlayer();

    changeQuote();
    
    updateAllClocks();
    clockUpdateInterval = setInterval(updateAllClocks, 1000);
    state.alarmCheckInterval = setInterval(checkAlarms, 1000);
};

init();
    </script>
</body>
</html>
